[2025-11-19 12:08:40,642][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:08:40,643][datasets][INFO] - JAX version 0.6.1 available.
Hybrid Evaluation Configuration:
  Base model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading base model...
Loading preconditioned model...
Generating base model predictions...
Generating preconditioned model predictions...
Generated 4227 forecast pairs
Extracting input windows from test data...
Extracted 4227 input windows
Creating hybrid forecasts...
Created 4227 hybrid forecasts
Computing metrics...

================================================================================
HYBRID EVALUATION METRICS
================================================================================
       MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]    MSIS  mean_weighted_sum_quantile_loss
None 8626473.051  1232.923      0.200       0.288     25.025    2937.086        0.459    0.193 872.897                            0.187
================================================================================

Metrics saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/2025-11-19/12-08-40/metrics_hybrid.csv


Base model:   0%|          | 0/4227 [00:00<?, ?it/s]
Base model:   0%|          | 1/4227 [00:00<17:31,  4.02it/s]
Base model:   5%|▍         | 193/4227 [00:00<00:06, 668.20it/s]
Base model:   9%|▉         | 385/4227 [00:00<00:03, 1029.49it/s]
Base model:  14%|█▎        | 577/4227 [00:00<00:02, 1256.74it/s]
Base model:  18%|█▊        | 769/4227 [00:00<00:02, 1405.70it/s]
Base model:  23%|██▎       | 961/4227 [00:00<00:02, 1502.38it/s]
Base model:  27%|██▋       | 1153/4227 [00:00<00:01, 1566.26it/s]
Base model:  32%|███▏      | 1345/4227 [00:01<00:01, 1608.55it/s]
Base model:  36%|███▋      | 1537/4227 [00:01<00:01, 1636.35it/s]
Base model:  41%|████      | 1729/4227 [00:01<00:01, 1654.88it/s]
Base model:  45%|████▍     | 1897/4227 [00:01<00:01, 1637.47it/s]
Base model:  49%|████▉     | 2081/4227 [00:01<00:01, 1635.65it/s]
Base model:  54%|█████▍    | 2273/4227 [00:01<00:01, 1656.29it/s]
Base model:  58%|█████▊    | 2465/4227 [00:01<00:01, 1673.38it/s]
Base model:  63%|██████▎   | 2657/4227 [00:01<00:00, 1686.86it/s]
Base model:  67%|██████▋   | 2849/4227 [00:01<00:00, 1695.71it/s]
Base model:  72%|███████▏  | 3041/4227 [00:02<00:00, 1703.88it/s]
Base model:  76%|███████▋  | 3233/4227 [00:02<00:00, 1708.88it/s]
Base model:  81%|████████  | 3425/4227 [00:02<00:00, 1710.73it/s]
Base model:  86%|████████▌ | 3617/4227 [00:02<00:00, 1712.91it/s]
Base model:  90%|█████████ | 3809/4227 [00:02<00:00, 1712.12it/s]
Base model:  95%|█████████▍| 4001/4227 [00:02<00:00, 1711.82it/s]
Base model:  99%|█████████▉| 4193/4227 [00:02<00:00, 1708.71it/s]
Base model: 100%|██████████| 4227/4227 [00:02<00:00, 1536.69it/s]

Precond model:   0%|          | 0/4227 [00:00<?, ?it/s]
Precond model:   4%|▎         | 154/4227 [00:00<00:02, 1539.91it/s]
Precond model:   8%|▊         | 321/4227 [00:00<00:02, 1459.83it/s]
Precond model:  12%|█▏        | 513/4227 [00:00<00:02, 1532.26it/s]
Precond model:  16%|█▌        | 673/4227 [00:00<00:02, 1542.35it/s]
Precond model:  20%|█▉        | 837/4227 [00:00<00:02, 1575.44it/s]
Precond model:  24%|██▍       | 1022/4227 [00:00<00:01, 1665.05it/s]
Precond model:  28%|██▊       | 1190/4227 [00:00<00:01, 1571.88it/s]
Precond model:  32%|███▏      | 1349/4227 [00:00<00:01, 1533.35it/s]
Precond model:  36%|███▋      | 1537/4227 [00:00<00:01, 1548.50it/s]
Precond model:  41%|████      | 1729/4227 [00:01<00:01, 1569.56it/s]
Precond model:  45%|████▌     | 1921/4227 [00:01<00:01, 1585.50it/s]
Precond model:  50%|████▉     | 2113/4227 [00:01<00:01, 1595.55it/s]
Precond model:  55%|█████▍    | 2305/4227 [00:01<00:01, 1598.93it/s]
Precond model:  59%|█████▊    | 2481/4227 [00:01<00:01, 1642.25it/s]
Precond model:  63%|██████▎   | 2646/4227 [00:01<00:00, 1642.83it/s]
Precond model:  67%|██████▋   | 2811/4227 [00:01<00:00, 1643.10it/s]
Precond model:  70%|███████   | 2977/4227 [00:01<00:00, 1560.28it/s]
Precond model:  75%|███████▍  | 3169/4227 [00:02<00:00, 1575.73it/s]
Precond model:  79%|███████▉  | 3329/4227 [00:02<00:00, 1581.31it/s]
Precond model:  83%|████████▎ | 3502/4227 [00:02<00:00, 1623.22it/s]
Precond model:  87%|████████▋ | 3665/4227 [00:02<00:00, 1574.77it/s]
Precond model:  91%|█████████ | 3841/4227 [00:02<00:00, 1503.00it/s]
Precond model:  95%|█████████▍| 4001/4227 [00:02<00:00, 1528.10it/s]
Precond model:  99%|█████████▉| 4193/4227 [00:02<00:00, 1555.92it/s]
Precond model: 100%|██████████| 4227/4227 [00:02<00:00, 1578.94it/s]

Hybridizing:   0%|          | 0/4227 [00:00<?, ?it/s]
Hybridizing:   1%|          | 25/4227 [00:00<00:17, 246.25it/s]
Hybridizing:   1%|          | 51/4227 [00:00<00:16, 249.79it/s]
Hybridizing:   2%|▏         | 77/4227 [00:00<00:16, 253.33it/s]
Hybridizing:   2%|▏         | 103/4227 [00:00<00:16, 251.21it/s]
Hybridizing:   3%|▎         | 129/4227 [00:00<00:16, 247.75it/s]
Hybridizing:   4%|▎         | 155/4227 [00:00<00:16, 248.65it/s]
Hybridizing:   4%|▍         | 180/4227 [00:00<00:16, 247.85it/s]
Hybridizing:   5%|▍         | 205/4227 [00:00<00:16, 247.43it/s]
Hybridizing:   5%|▌         | 230/4227 [00:00<00:16, 248.08it/s]
Hybridizing:   6%|▌         | 256/4227 [00:01<00:15, 249.49it/s]
Hybridizing:   7%|▋         | 281/4227 [00:01<00:16, 241.04it/s]
Hybridizing:   7%|▋         | 307/4227 [00:01<00:16, 244.17it/s]
Hybridizing:   8%|▊         | 332/4227 [00:01<00:15, 244.79it/s]
Hybridizing:   8%|▊         | 358/4227 [00:01<00:15, 246.68it/s]
Hybridizing:   9%|▉         | 383/4227 [00:01<00:15, 246.56it/s]
Hybridizing:  10%|▉         | 409/4227 [00:01<00:15, 249.36it/s]
Hybridizing:  10%|█         | 435/4227 [00:01<00:15, 250.74it/s]
Hybridizing:  11%|█         | 461/4227 [00:01<00:14, 252.14it/s]
Hybridizing:  12%|█▏        | 487/4227 [00:01<00:14, 250.94it/s]
Hybridizing:  12%|█▏        | 513/4227 [00:02<00:14, 250.72it/s]
Hybridizing:  13%|█▎        | 539/4227 [00:02<00:14, 249.86it/s]
Hybridizing:  13%|█▎        | 564/4227 [00:02<00:14, 249.52it/s]
Hybridizing:  14%|█▍        | 590/4227 [00:02<00:14, 249.84it/s]
Hybridizing:  15%|█▍        | 615/4227 [00:02<00:14, 249.35it/s]
Hybridizing:  15%|█▌        | 640/4227 [00:02<00:14, 249.05it/s]
Hybridizing:  16%|█▌        | 665/4227 [00:02<00:14, 248.96it/s]
Hybridizing:  16%|█▋        | 690/4227 [00:02<00:14, 240.55it/s]
Hybridizing:  17%|█▋        | 715/4227 [00:02<00:14, 242.85it/s]
Hybridizing:  18%|█▊        | 740/4227 [00:02<00:14, 244.45it/s]
Hybridizing:  18%|█▊        | 765/4227 [00:03<00:14, 245.67it/s]
Hybridizing:  19%|█▊        | 791/4227 [00:03<00:13, 247.20it/s]
Hybridizing:  19%|█▉        | 816/4227 [00:03<00:13, 247.61it/s]
Hybridizing:  20%|█▉        | 841/4227 [00:03<00:13, 247.84it/s]
Hybridizing:  20%|██        | 866/4227 [00:03<00:13, 247.86it/s]
Hybridizing:  21%|██        | 892/4227 [00:03<00:13, 248.82it/s]
Hybridizing:  22%|██▏       | 917/4227 [00:03<00:13, 248.78it/s]
Hybridizing:  22%|██▏       | 942/4227 [00:03<00:13, 246.67it/s]
Hybridizing:  23%|██▎       | 967/4227 [00:03<00:13, 247.25it/s]
Hybridizing:  23%|██▎       | 993/4227 [00:04<00:13, 248.31it/s]
Hybridizing:  24%|██▍       | 1018/4227 [00:04<00:12, 248.37it/s]
Hybridizing:  25%|██▍       | 1043/4227 [00:04<00:12, 248.54it/s]
Hybridizing:  25%|██▌       | 1068/4227 [00:04<00:12, 248.77it/s]
Hybridizing:  26%|██▌       | 1093/4227 [00:04<00:12, 248.28it/s]
Hybridizing:  26%|██▋       | 1118/4227 [00:04<00:12, 248.39it/s]
Hybridizing:  27%|██▋       | 1143/4227 [00:04<00:12, 248.30it/s]
Hybridizing:  28%|██▊       | 1168/4227 [00:04<00:12, 248.55it/s]
Hybridizing:  28%|██▊       | 1194/4227 [00:04<00:12, 249.33it/s]
Hybridizing:  29%|██▉       | 1219/4227 [00:04<00:12, 249.25it/s]
Hybridizing:  29%|██▉       | 1244/4227 [00:05<00:11, 249.00it/s]
Hybridizing:  30%|███       | 1269/4227 [00:05<00:11, 248.87it/s]
Hybridizing:  31%|███       | 1295/4227 [00:05<00:11, 249.48it/s]
Hybridizing:  31%|███       | 1320/4227 [00:05<00:11, 249.31it/s]
Hybridizing:  32%|███▏      | 1345/4227 [00:05<00:11, 249.03it/s]
Hybridizing:  32%|███▏      | 1370/4227 [00:05<00:11, 249.18it/s]
Hybridizing:  33%|███▎      | 1396/4227 [00:05<00:11, 249.82it/s]
Hybridizing:  34%|███▎      | 1421/4227 [00:05<00:11, 249.55it/s]
Hybridizing:  34%|███▍      | 1446/4227 [00:05<00:11, 249.32it/s]
Hybridizing:  35%|███▍      | 1471/4227 [00:05<00:11, 249.33it/s]
Hybridizing:  35%|███▌      | 1497/4227 [00:06<00:10, 249.96it/s]
Hybridizing:  36%|███▌      | 1522/4227 [00:06<00:10, 249.64it/s]
Hybridizing:  37%|███▋      | 1547/4227 [00:06<00:11, 239.68it/s]
Hybridizing:  37%|███▋      | 1572/4227 [00:06<00:10, 242.24it/s]
Hybridizing:  38%|███▊      | 1598/4227 [00:06<00:10, 244.78it/s]
Hybridizing:  38%|███▊      | 1624/4227 [00:06<00:10, 246.68it/s]
Hybridizing:  39%|███▉      | 1650/4227 [00:06<00:10, 248.80it/s]
Hybridizing:  40%|███▉      | 1676/4227 [00:06<00:10, 250.28it/s]
Hybridizing:  40%|████      | 1702/4227 [00:06<00:10, 250.97it/s]
Hybridizing:  41%|████      | 1728/4227 [00:06<00:09, 252.21it/s]
Hybridizing:  41%|████▏     | 1754/4227 [00:07<00:09, 252.51it/s]
Hybridizing:  42%|████▏     | 1780/4227 [00:07<00:09, 253.56it/s]
Hybridizing:  43%|████▎     | 1806/4227 [00:07<00:09, 252.27it/s]
Hybridizing:  43%|████▎     | 1832/4227 [00:07<00:09, 252.38it/s]
Hybridizing:  44%|████▍     | 1858/4227 [00:07<00:09, 252.04it/s]
Hybridizing:  45%|████▍     | 1884/4227 [00:07<00:09, 253.63it/s]
Hybridizing:  45%|████▌     | 1910/4227 [00:07<00:09, 254.38it/s]
Hybridizing:  46%|████▌     | 1936/4227 [00:07<00:08, 255.36it/s]
Hybridizing:  46%|████▋     | 1962/4227 [00:07<00:08, 254.83it/s]
Hybridizing:  47%|████▋     | 1988/4227 [00:07<00:08, 253.51it/s]
Hybridizing:  48%|████▊     | 2014/4227 [00:08<00:08, 254.60it/s]
Hybridizing:  48%|████▊     | 2040/4227 [00:08<00:08, 252.86it/s]
Hybridizing:  49%|████▉     | 2066/4227 [00:08<00:08, 254.12it/s]
Hybridizing:  49%|████▉     | 2092/4227 [00:08<00:08, 253.28it/s]
Hybridizing:  50%|█████     | 2118/4227 [00:08<00:08, 254.99it/s]
Hybridizing:  51%|█████     | 2144/4227 [00:08<00:08, 255.21it/s]
Hybridizing:  51%|█████▏    | 2171/4227 [00:08<00:07, 257.13it/s]
Hybridizing:  52%|█████▏    | 2198/4227 [00:08<00:07, 259.26it/s]
Hybridizing:  53%|█████▎    | 2224/4227 [00:08<00:07, 259.38it/s]
Hybridizing:  53%|█████▎    | 2250/4227 [00:09<00:07, 255.91it/s]
Hybridizing:  54%|█████▍    | 2276/4227 [00:09<00:07, 253.66it/s]
Hybridizing:  54%|█████▍    | 2302/4227 [00:09<00:07, 252.05it/s]
Hybridizing:  55%|█████▌    | 2328/4227 [00:09<00:07, 251.67it/s]
Hybridizing:  56%|█████▌    | 2354/4227 [00:09<00:07, 250.57it/s]
Hybridizing:  56%|█████▋    | 2380/4227 [00:09<00:07, 249.91it/s]
Hybridizing:  57%|█████▋    | 2405/4227 [00:09<00:07, 249.42it/s]
Hybridizing:  57%|█████▋    | 2430/4227 [00:09<00:07, 249.14it/s]
Hybridizing:  58%|█████▊    | 2455/4227 [00:09<00:07, 249.38it/s]
Hybridizing:  59%|█████▊    | 2480/4227 [00:09<00:07, 240.21it/s]
Hybridizing:  59%|█████▉    | 2505/4227 [00:10<00:07, 242.62it/s]
Hybridizing:  60%|█████▉    | 2530/4227 [00:10<00:06, 244.37it/s]
Hybridizing:  60%|██████    | 2556/4227 [00:10<00:06, 246.25it/s]
Hybridizing:  61%|██████    | 2581/4227 [00:10<00:06, 247.07it/s]
Hybridizing:  62%|██████▏   | 2606/4227 [00:10<00:06, 247.37it/s]
Hybridizing:  62%|██████▏   | 2631/4227 [00:10<00:06, 247.74it/s]
Hybridizing:  63%|██████▎   | 2657/4227 [00:10<00:06, 248.63it/s]
Hybridizing:  63%|██████▎   | 2682/4227 [00:10<00:06, 248.49it/s]
Hybridizing:  64%|██████▍   | 2707/4227 [00:10<00:06, 248.44it/s]
Hybridizing:  65%|██████▍   | 2732/4227 [00:10<00:06, 248.54it/s]
Hybridizing:  65%|██████▌   | 2758/4227 [00:11<00:05, 249.10it/s]
Hybridizing:  66%|██████▌   | 2783/4227 [00:11<00:06, 240.24it/s]
Hybridizing:  66%|██████▋   | 2808/4227 [00:11<00:05, 242.21it/s]
Hybridizing:  67%|██████▋   | 2833/4227 [00:11<00:05, 243.83it/s]
Hybridizing:  68%|██████▊   | 2858/4227 [00:11<00:05, 237.33it/s]
Hybridizing:  68%|██████▊   | 2883/4227 [00:11<00:05, 240.47it/s]
Hybridizing:  69%|██████▉   | 2908/4227 [00:11<00:05, 242.63it/s]
Hybridizing:  69%|██████▉   | 2933/4227 [00:11<00:05, 244.07it/s]
Hybridizing:  70%|██████▉   | 2958/4227 [00:11<00:05, 245.73it/s]
Hybridizing:  71%|███████   | 2983/4227 [00:11<00:05, 246.42it/s]
Hybridizing:  71%|███████   | 3008/4227 [00:12<00:04, 246.85it/s]
Hybridizing:  72%|███████▏  | 3033/4227 [00:12<00:04, 247.05it/s]
Hybridizing:  72%|███████▏  | 3058/4227 [00:12<00:04, 247.88it/s]
Hybridizing:  73%|███████▎  | 3083/4227 [00:12<00:04, 247.92it/s]
Hybridizing:  74%|███████▎  | 3108/4227 [00:12<00:04, 247.85it/s]
Hybridizing:  74%|███████▍  | 3133/4227 [00:12<00:04, 247.75it/s]
Hybridizing:  75%|███████▍  | 3159/4227 [00:12<00:04, 248.52it/s]
Hybridizing:  75%|███████▌  | 3184/4227 [00:12<00:04, 248.31it/s]
Hybridizing:  76%|███████▌  | 3209/4227 [00:12<00:04, 248.08it/s]
Hybridizing:  77%|███████▋  | 3234/4227 [00:13<00:04, 248.05it/s]
Hybridizing:  77%|███████▋  | 3259/4227 [00:13<00:03, 248.57it/s]
Hybridizing:  78%|███████▊  | 3284/4227 [00:13<00:03, 238.95it/s]
Hybridizing:  78%|███████▊  | 3309/4227 [00:13<00:03, 241.58it/s]
Hybridizing:  79%|███████▉  | 3334/4227 [00:13<00:03, 243.60it/s]
Hybridizing:  79%|███████▉  | 3360/4227 [00:13<00:03, 245.65it/s]
Hybridizing:  80%|████████  | 3385/4227 [00:13<00:03, 246.31it/s]
Hybridizing:  81%|████████  | 3410/4227 [00:13<00:03, 246.96it/s]
Hybridizing:  81%|████████▏ | 3435/4227 [00:13<00:03, 247.42it/s]
Hybridizing:  82%|████████▏ | 3461/4227 [00:13<00:03, 248.41it/s]
Hybridizing:  82%|████████▏ | 3486/4227 [00:14<00:02, 248.35it/s]
Hybridizing:  83%|████████▎ | 3511/4227 [00:14<00:02, 248.23it/s]
Hybridizing:  84%|████████▎ | 3536/4227 [00:14<00:02, 248.05it/s]
Hybridizing:  84%|████████▍ | 3562/4227 [00:14<00:02, 248.80it/s]
Hybridizing:  85%|████████▍ | 3587/4227 [00:14<00:02, 248.68it/s]
Hybridizing:  85%|████████▌ | 3612/4227 [00:14<00:02, 248.64it/s]
Hybridizing:  86%|████████▌ | 3638/4227 [00:14<00:02, 250.19it/s]
Hybridizing:  87%|████████▋ | 3664/4227 [00:14<00:02, 251.34it/s]
Hybridizing:  87%|████████▋ | 3690/4227 [00:14<00:02, 252.99it/s]
Hybridizing:  88%|████████▊ | 3716/4227 [00:14<00:02, 254.33it/s]
Hybridizing:  89%|████████▊ | 3742/4227 [00:15<00:01, 255.69it/s]
Hybridizing:  89%|████████▉ | 3768/4227 [00:15<00:01, 255.56it/s]
Hybridizing:  90%|████████▉ | 3794/4227 [00:15<00:01, 256.06it/s]
Hybridizing:  90%|█████████ | 3820/4227 [00:15<00:01, 255.33it/s]
Hybridizing:  91%|█████████ | 3846/4227 [00:15<00:01, 255.60it/s]
Hybridizing:  92%|█████████▏| 3872/4227 [00:15<00:01, 255.54it/s]
Hybridizing:  92%|█████████▏| 3898/4227 [00:15<00:01, 255.87it/s]
Hybridizing:  93%|█████████▎| 3924/4227 [00:15<00:01, 256.97it/s]
Hybridizing:  93%|█████████▎| 3950/4227 [00:15<00:01, 256.83it/s]
Hybridizing:  94%|█████████▍| 3976/4227 [00:15<00:00, 256.09it/s]
Hybridizing:  95%|█████████▍| 4002/4227 [00:16<00:00, 254.41it/s]
Hybridizing:  95%|█████████▌| 4028/4227 [00:16<00:00, 255.51it/s]
Hybridizing:  96%|█████████▌| 4054/4227 [00:16<00:00, 256.80it/s]
Hybridizing:  97%|█████████▋| 4081/4227 [00:16<00:00, 259.59it/s]
Hybridizing:  97%|█████████▋| 4107/4227 [00:16<00:00, 258.46it/s]
Hybridizing:  98%|█████████▊| 4133/4227 [00:16<00:00, 256.70it/s]
Hybridizing:  98%|█████████▊| 4159/4227 [00:16<00:00, 253.06it/s]
Hybridizing:  99%|█████████▉| 4185/4227 [00:16<00:00, 244.50it/s]
Hybridizing: 100%|█████████▉| 4211/4227 [00:16<00:00, 247.82it/s]
Hybridizing: 100%|██████████| 4227/4227 [00:16<00:00, 249.33it/s]

0it [00:00, ?it/s]
160it [00:00, 1511.74it/s]
320it [00:00, 1502.98it/s]
480it [00:00, 1454.97it/s]
640it [00:00, 1285.86it/s]
800it [00:00, 1126.41it/s]
928it [00:00, 1055.24it/s]
1056it [00:00, 1034.11it/s]
1184it [00:01, 1001.58it/s]
1312it [00:01, 961.66it/s] 
1440it [00:01, 973.65it/s]
1568it [00:01, 959.82it/s]
1696it [00:01, 1003.71it/s]
1888it [00:01, 1210.13it/s]
2048it [00:01, 1255.98it/s]
2240it [00:01, 1371.73it/s]
2400it [00:02, 1188.93it/s]
2528it [00:02, 1119.15it/s]
2656it [00:02, 1088.45it/s]
2784it [00:02, 1029.52it/s]
2912it [00:02, 994.54it/s] 
3040it [00:02, 977.45it/s]
3168it [00:02, 971.06it/s]
3296it [00:03, 947.06it/s]
3392it [00:03, 908.66it/s]
3488it [00:03, 915.32it/s]
3584it [00:03, 903.92it/s]
3744it [00:03, 1085.14it/s]
3936it [00:03, 1295.63it/s]
4128it [00:03, 1445.40it/s]
4227it [00:03, 1125.38it/s]
