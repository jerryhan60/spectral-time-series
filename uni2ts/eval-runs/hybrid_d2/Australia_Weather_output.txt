[2025-11-19 12:08:04,125][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:08:04,127][datasets][INFO] - JAX version 0.6.1 available.
Hybrid Evaluation Configuration:
  Base model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading base model...
Loading preconditioned model...
Generating base model predictions...
Generating preconditioned model predictions...
Generated 3010 forecast pairs
Extracting input windows from test data...
Extracted 3010 input windows
Creating hybrid forecasts...
Created 3010 hybrid forecasts
Computing metrics...

================================================================================
HYBRID EVALUATION METRICS
================================================================================
      MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]   MSIS  mean_weighted_sum_quantile_loss
None    250.188     2.075      0.488       0.645      0.983      15.817        1.505    0.197 11.426                            0.161
================================================================================

Metrics saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/2025-11-19/12-08-03/metrics_hybrid.csv


Base model:   0%|          | 0/3010 [00:00<?, ?it/s]
Base model:   0%|          | 1/3010 [00:00<12:19,  4.07it/s]
Base model:   5%|▌         | 161/3010 [00:00<00:05, 568.21it/s]
Base model:  12%|█▏        | 353/3010 [00:00<00:02, 963.39it/s]
Base model:  17%|█▋        | 513/3010 [00:00<00:02, 1129.52it/s]
Base model:  23%|██▎       | 705/3010 [00:00<00:01, 1299.30it/s]
Base model:  30%|██▉       | 897/3010 [00:00<00:01, 1418.05it/s]
Base model:  36%|███▌      | 1089/3010 [00:00<00:01, 1496.81it/s]
Base model:  43%|████▎     | 1281/3010 [00:01<00:01, 1549.64it/s]
Base model:  49%|████▉     | 1473/3010 [00:01<00:00, 1585.55it/s]
Base model:  55%|█████▌    | 1665/3010 [00:01<00:00, 1610.65it/s]
Base model:  62%|██████▏   | 1857/3010 [00:01<00:00, 1627.22it/s]
Base model:  68%|██████▊   | 2049/3010 [00:01<00:00, 1635.73it/s]
Base model:  74%|███████▍  | 2241/3010 [00:01<00:00, 1646.39it/s]
Base model:  81%|████████  | 2433/3010 [00:01<00:00, 1662.28it/s]
Base model:  86%|████████▋ | 2600/3010 [00:01<00:00, 1643.64it/s]
Base model:  93%|█████████▎| 2785/3010 [00:01<00:00, 1645.59it/s]
Base model:  98%|█████████▊| 2950/3010 [00:02<00:00, 1627.11it/s]
Base model: 100%|██████████| 3010/3010 [00:02<00:00, 1435.72it/s]

Precond model:   0%|          | 0/3010 [00:00<?, ?it/s]
Precond model:   4%|▍         | 129/3010 [00:00<00:02, 1046.76it/s]
Precond model:  10%|▉         | 289/3010 [00:00<00:02, 1194.77it/s]
Precond model:  15%|█▍        | 449/3010 [00:00<00:02, 1241.02it/s]
Precond model:  20%|██        | 609/3010 [00:00<00:01, 1267.23it/s]
Precond model:  26%|██▌       | 769/3010 [00:00<00:01, 1302.54it/s]
Precond model:  31%|███       | 929/3010 [00:00<00:01, 1337.65it/s]
Precond model:  36%|███▌      | 1089/3010 [00:00<00:01, 1365.35it/s]
Precond model:  41%|████▏     | 1249/3010 [00:00<00:01, 1379.85it/s]
Precond model:  47%|████▋     | 1409/3010 [00:01<00:01, 1386.68it/s]
Precond model:  52%|█████▏    | 1569/3010 [00:01<00:01, 1393.54it/s]
Precond model:  57%|█████▋    | 1729/3010 [00:01<00:00, 1400.64it/s]
Precond model:  63%|██████▎   | 1889/3010 [00:01<00:00, 1400.35it/s]
Precond model:  67%|██████▋   | 2030/3010 [00:01<00:00, 1399.13it/s]
Precond model:  72%|███████▏  | 2177/3010 [00:01<00:00, 1366.25it/s]
Precond model:  78%|███████▊  | 2337/3010 [00:01<00:00, 1400.06it/s]
Precond model:  83%|████████▎ | 2497/3010 [00:01<00:00, 1387.59it/s]
Precond model:  88%|████████▊ | 2657/3010 [00:01<00:00, 1419.92it/s]
Precond model:  94%|█████████▎| 2817/3010 [00:02<00:00, 1443.79it/s]
Precond model:  99%|█████████▉| 2977/3010 [00:02<00:00, 1460.98it/s]
Precond model: 100%|██████████| 3010/3010 [00:02<00:00, 1382.44it/s]

Hybridizing:   0%|          | 0/3010 [00:00<?, ?it/s]
Hybridizing:   1%|          | 27/3010 [00:00<00:11, 265.34it/s]
Hybridizing:   2%|▏         | 54/3010 [00:00<00:11, 265.81it/s]
Hybridizing:   3%|▎         | 81/3010 [00:00<00:11, 265.84it/s]
Hybridizing:   4%|▎         | 108/3010 [00:00<00:10, 266.03it/s]
Hybridizing:   4%|▍         | 135/3010 [00:00<00:10, 265.74it/s]
Hybridizing:   5%|▌         | 162/3010 [00:00<00:10, 265.94it/s]
Hybridizing:   6%|▋         | 189/3010 [00:00<00:10, 266.02it/s]
Hybridizing:   7%|▋         | 216/3010 [00:00<00:10, 266.13it/s]
Hybridizing:   8%|▊         | 243/3010 [00:00<00:10, 266.28it/s]
Hybridizing:   9%|▉         | 270/3010 [00:01<00:10, 266.69it/s]
Hybridizing:  10%|▉         | 297/3010 [00:01<00:10, 267.40it/s]
Hybridizing:  11%|█         | 325/3010 [00:01<00:09, 268.68it/s]
Hybridizing:  12%|█▏        | 352/3010 [00:01<00:10, 259.11it/s]
Hybridizing:  13%|█▎        | 380/3010 [00:01<00:10, 262.69it/s]
Hybridizing:  14%|█▎        | 407/3010 [00:01<00:09, 263.74it/s]
Hybridizing:  14%|█▍        | 434/3010 [00:01<00:10, 257.41it/s]
Hybridizing:  15%|█▌        | 461/3010 [00:01<00:09, 260.03it/s]
Hybridizing:  16%|█▌        | 489/3010 [00:01<00:09, 263.22it/s]
Hybridizing:  17%|█▋        | 516/3010 [00:01<00:09, 264.71it/s]
Hybridizing:  18%|█▊        | 544/3010 [00:02<00:09, 266.52it/s]
Hybridizing:  19%|█▉        | 571/3010 [00:02<00:09, 267.01it/s]
Hybridizing:  20%|█▉        | 599/3010 [00:02<00:08, 268.10it/s]
Hybridizing:  21%|██        | 626/3010 [00:02<00:08, 268.26it/s]
Hybridizing:  22%|██▏       | 654/3010 [00:02<00:08, 269.13it/s]
Hybridizing:  23%|██▎       | 681/3010 [00:02<00:08, 268.86it/s]
Hybridizing:  24%|██▎       | 709/3010 [00:02<00:08, 269.44it/s]
Hybridizing:  24%|██▍       | 736/3010 [00:02<00:08, 269.24it/s]
Hybridizing:  25%|██▌       | 764/3010 [00:02<00:08, 269.65it/s]
Hybridizing:  26%|██▋       | 791/3010 [00:02<00:08, 269.33it/s]
Hybridizing:  27%|██▋       | 818/3010 [00:03<00:08, 258.43it/s]
Hybridizing:  28%|██▊       | 845/3010 [00:03<00:08, 261.48it/s]
Hybridizing:  29%|██▉       | 872/3010 [00:03<00:08, 254.09it/s]
Hybridizing:  30%|██▉       | 899/3010 [00:03<00:08, 258.44it/s]
Hybridizing:  31%|███       | 927/3010 [00:03<00:07, 262.32it/s]
Hybridizing:  32%|███▏      | 954/3010 [00:03<00:07, 264.25it/s]
Hybridizing:  33%|███▎      | 982/3010 [00:03<00:07, 266.59it/s]
Hybridizing:  34%|███▎      | 1009/3010 [00:03<00:07, 267.31it/s]
Hybridizing:  34%|███▍      | 1037/3010 [00:03<00:07, 268.38it/s]
Hybridizing:  35%|███▌      | 1064/3010 [00:04<00:07, 268.31it/s]
Hybridizing:  36%|███▋      | 1092/3010 [00:04<00:07, 269.13it/s]
Hybridizing:  37%|███▋      | 1119/3010 [00:04<00:07, 268.83it/s]
Hybridizing:  38%|███▊      | 1146/3010 [00:04<00:06, 269.10it/s]
Hybridizing:  39%|███▉      | 1173/3010 [00:04<00:06, 268.88it/s]
Hybridizing:  40%|███▉      | 1201/3010 [00:04<00:06, 269.43it/s]
Hybridizing:  41%|████      | 1228/3010 [00:04<00:06, 269.25it/s]
Hybridizing:  42%|████▏     | 1256/3010 [00:04<00:06, 270.01it/s]
Hybridizing:  43%|████▎     | 1284/3010 [00:04<00:06, 260.07it/s]
Hybridizing:  44%|████▎     | 1311/3010 [00:04<00:06, 250.69it/s]
Hybridizing:  44%|████▍     | 1338/3010 [00:05<00:06, 255.88it/s]
Hybridizing:  45%|████▌     | 1365/3010 [00:05<00:06, 259.75it/s]
Hybridizing:  46%|████▌     | 1392/3010 [00:05<00:06, 262.27it/s]
Hybridizing:  47%|████▋     | 1419/3010 [00:05<00:06, 264.08it/s]
Hybridizing:  48%|████▊     | 1446/3010 [00:05<00:05, 265.34it/s]
Hybridizing:  49%|████▉     | 1473/3010 [00:05<00:05, 266.35it/s]
Hybridizing:  50%|████▉     | 1500/3010 [00:05<00:05, 267.04it/s]
Hybridizing:  51%|█████     | 1527/3010 [00:05<00:05, 267.32it/s]
Hybridizing:  52%|█████▏    | 1554/3010 [00:05<00:05, 267.80it/s]
Hybridizing:  53%|█████▎    | 1581/3010 [00:05<00:05, 268.33it/s]
Hybridizing:  53%|█████▎    | 1608/3010 [00:06<00:05, 268.60it/s]
Hybridizing:  54%|█████▍    | 1635/3010 [00:06<00:05, 268.84it/s]
Hybridizing:  55%|█████▌    | 1662/3010 [00:06<00:05, 268.94it/s]
Hybridizing:  56%|█████▌    | 1689/3010 [00:06<00:05, 258.48it/s]
Hybridizing:  57%|█████▋    | 1716/3010 [00:06<00:04, 261.49it/s]
Hybridizing:  58%|█████▊    | 1743/3010 [00:06<00:04, 253.96it/s]
Hybridizing:  59%|█████▉    | 1770/3010 [00:06<00:04, 258.17it/s]
Hybridizing:  60%|█████▉    | 1797/3010 [00:06<00:04, 261.20it/s]
Hybridizing:  61%|██████    | 1824/3010 [00:06<00:04, 263.47it/s]
Hybridizing:  61%|██████▏   | 1851/3010 [00:06<00:04, 265.11it/s]
Hybridizing:  62%|██████▏   | 1878/3010 [00:07<00:04, 266.28it/s]
Hybridizing:  63%|██████▎   | 1905/3010 [00:07<00:04, 267.22it/s]
Hybridizing:  64%|██████▍   | 1932/3010 [00:07<00:04, 267.77it/s]
Hybridizing:  65%|██████▌   | 1959/3010 [00:07<00:03, 268.35it/s]
Hybridizing:  66%|██████▌   | 1986/3010 [00:07<00:03, 268.39it/s]
Hybridizing:  67%|██████▋   | 2013/3010 [00:07<00:03, 268.40it/s]
Hybridizing:  68%|██████▊   | 2040/3010 [00:07<00:03, 268.51it/s]
Hybridizing:  69%|██████▊   | 2067/3010 [00:07<00:03, 268.85it/s]
Hybridizing:  70%|██████▉   | 2094/3010 [00:07<00:03, 268.99it/s]
Hybridizing:  70%|███████   | 2121/3010 [00:07<00:03, 269.07it/s]
Hybridizing:  71%|███████▏  | 2148/3010 [00:08<00:03, 258.09it/s]
Hybridizing:  72%|███████▏  | 2175/3010 [00:08<00:03, 261.48it/s]
Hybridizing:  73%|███████▎  | 2202/3010 [00:08<00:03, 261.32it/s]
Hybridizing:  74%|███████▍  | 2229/3010 [00:08<00:02, 263.50it/s]
Hybridizing:  75%|███████▍  | 2256/3010 [00:08<00:02, 255.53it/s]
Hybridizing:  76%|███████▌  | 2283/3010 [00:08<00:02, 259.47it/s]
Hybridizing:  77%|███████▋  | 2310/3010 [00:08<00:02, 262.09it/s]
Hybridizing:  78%|███████▊  | 2337/3010 [00:08<00:02, 264.20it/s]
Hybridizing:  79%|███████▊  | 2364/3010 [00:08<00:02, 265.59it/s]
Hybridizing:  79%|███████▉  | 2391/3010 [00:09<00:02, 266.53it/s]
Hybridizing:  80%|████████  | 2418/3010 [00:09<00:02, 267.21it/s]
Hybridizing:  81%|████████  | 2445/3010 [00:09<00:02, 267.68it/s]
Hybridizing:  82%|████████▏ | 2472/3010 [00:09<00:02, 267.86it/s]
Hybridizing:  83%|████████▎ | 2499/3010 [00:09<00:01, 268.09it/s]
Hybridizing:  84%|████████▍ | 2526/3010 [00:09<00:01, 268.24it/s]
Hybridizing:  85%|████████▍ | 2553/3010 [00:09<00:01, 268.67it/s]
Hybridizing:  86%|████████▌ | 2580/3010 [00:09<00:01, 269.04it/s]
Hybridizing:  87%|████████▋ | 2607/3010 [00:09<00:01, 269.19it/s]
Hybridizing:  88%|████████▊ | 2634/3010 [00:09<00:01, 259.92it/s]
Hybridizing:  88%|████████▊ | 2661/3010 [00:10<00:01, 261.09it/s]
Hybridizing:  89%|████████▉ | 2688/3010 [00:10<00:01, 263.33it/s]
Hybridizing:  90%|█████████ | 2715/3010 [00:10<00:01, 264.99it/s]
Hybridizing:  91%|█████████ | 2742/3010 [00:10<00:01, 255.82it/s]
Hybridizing:  92%|█████████▏| 2769/3010 [00:10<00:00, 259.80it/s]
Hybridizing:  93%|█████████▎| 2796/3010 [00:10<00:00, 262.51it/s]
Hybridizing:  94%|█████████▍| 2823/3010 [00:10<00:00, 264.27it/s]
Hybridizing:  95%|█████████▍| 2850/3010 [00:10<00:00, 265.29it/s]
Hybridizing:  96%|█████████▌| 2877/3010 [00:10<00:00, 266.15it/s]
Hybridizing:  96%|█████████▋| 2904/3010 [00:10<00:00, 266.97it/s]
Hybridizing:  97%|█████████▋| 2931/3010 [00:11<00:00, 267.43it/s]
Hybridizing:  98%|█████████▊| 2958/3010 [00:11<00:00, 267.97it/s]
Hybridizing:  99%|█████████▉| 2985/3010 [00:11<00:00, 268.28it/s]
Hybridizing: 100%|██████████| 3010/3010 [00:11<00:00, 265.01it/s]

0it [00:00, ?it/s]
32it [00:00, 311.71it/s]
64it [00:00, 278.24it/s]
96it [00:00, 275.82it/s]
128it [00:00, 250.59it/s]
160it [00:00, 236.04it/s]
192it [00:00, 250.25it/s]
224it [00:00, 260.78it/s]
256it [00:00, 266.54it/s]
288it [00:01, 267.69it/s]
320it [00:01, 279.58it/s]
352it [00:01, 277.35it/s]
384it [00:01, 277.38it/s]
416it [00:01, 258.92it/s]
448it [00:01, 254.60it/s]
480it [00:01, 263.68it/s]
512it [00:01, 267.89it/s]
544it [00:02, 252.77it/s]
576it [00:02, 255.73it/s]
608it [00:02, 251.77it/s]
640it [00:02, 253.38it/s]
672it [00:02, 262.43it/s]
704it [00:02, 274.21it/s]
736it [00:02, 270.70it/s]
800it [00:02, 317.99it/s]
864it [00:03, 331.59it/s]
928it [00:03, 343.15it/s]
992it [00:03, 359.33it/s]
1056it [00:03, 367.17it/s]
1120it [00:03, 354.83it/s]
1184it [00:04, 360.10it/s]
1248it [00:04, 363.10it/s]
1312it [00:04, 361.78it/s]
1376it [00:04, 362.28it/s]
1440it [00:04, 362.57it/s]
1504it [00:04, 370.61it/s]
1568it [00:05, 370.29it/s]
1632it [00:05, 363.21it/s]
1696it [00:05, 369.21it/s]
1760it [00:05, 372.90it/s]
1824it [00:05, 367.16it/s]
1888it [00:05, 366.55it/s]
1952it [00:06, 370.23it/s]
2016it [00:06, 369.86it/s]
2080it [00:06, 369.30it/s]
2144it [00:06, 358.72it/s]
2208it [00:06, 370.85it/s]
2272it [00:06, 393.14it/s]
2336it [00:07, 413.89it/s]
2400it [00:07, 418.91it/s]
2464it [00:07, 439.86it/s]
2528it [00:07, 450.59it/s]
2592it [00:07, 459.55it/s]
2656it [00:07, 468.67it/s]
2720it [00:07, 478.63it/s]
2784it [00:07, 490.06it/s]
2848it [00:08, 486.83it/s]
2912it [00:08, 483.02it/s]
2976it [00:08, 490.21it/s]
3010it [00:08, 356.39it/s]
