[2025-11-19 12:09:23,132][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:09:23,133][datasets][INFO] - JAX version 0.6.1 available.
Hybrid Evaluation Configuration:
  Base model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading base model...
Loading preconditioned model...
Generating base model predictions...
Generating preconditioned model predictions...
Generated 862 forecast pairs
Extracting input windows from test data...
Extracted 862 input windows
Creating hybrid forecasts...
Created 862 hybrid forecasts
Computing metrics...

================================================================================
HYBRID EVALUATION METRICS
================================================================================
      MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]   MSIS  mean_weighted_sum_quantile_loss
None      0.001     0.015      0.405       0.315      0.963       0.035        0.656    0.282 12.349                            0.237
================================================================================

Metrics saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/2025-11-19/12-09-22/metrics_hybrid.csv


Base model:   0%|          | 0/862 [00:00<?, ?it/s]
Base model:   0%|          | 1/862 [00:00<03:40,  3.91it/s]
Base model:  19%|█▊        | 161/862 [00:00<00:01, 565.43it/s]
Base model:  37%|███▋      | 321/862 [00:00<00:00, 893.65it/s]
Base model:  56%|█████▌    | 481/862 [00:00<00:00, 1103.43it/s]
Base model:  74%|███████▍  | 641/862 [00:00<00:00, 1239.92it/s]
Base model:  93%|█████████▎| 801/862 [00:00<00:00, 1335.97it/s]
Base model: 100%|██████████| 862/862 [00:00<00:00, 1078.32it/s]

Precond model:   0%|          | 0/862 [00:00<?, ?it/s]
Precond model:  15%|█▍        | 129/862 [00:00<00:00, 1061.62it/s]
Precond model:  34%|███▎      | 289/862 [00:00<00:00, 1214.71it/s]
Precond model:  52%|█████▏    | 449/862 [00:00<00:00, 1265.44it/s]
Precond model:  67%|██████▋   | 577/862 [00:00<00:00, 1237.40it/s]
Precond model:  85%|████████▌ | 737/862 [00:00<00:00, 1270.19it/s]
Precond model: 100%|██████████| 862/862 [00:00<00:00, 1298.57it/s]

Hybridizing:   0%|          | 0/862 [00:00<?, ?it/s]
Hybridizing:   1%|          | 5/862 [00:00<00:19, 44.74it/s]
Hybridizing:   1%|▏         | 11/862 [00:00<00:17, 48.48it/s]
Hybridizing:   2%|▏         | 17/862 [00:00<00:17, 49.62it/s]
Hybridizing:   3%|▎         | 23/862 [00:00<00:16, 50.20it/s]
Hybridizing:   3%|▎         | 29/862 [00:00<00:16, 50.48it/s]
Hybridizing:   4%|▍         | 35/862 [00:00<00:16, 50.14it/s]
Hybridizing:   5%|▍         | 41/862 [00:00<00:16, 50.34it/s]
Hybridizing:   5%|▌         | 47/862 [00:00<00:16, 50.54it/s]
Hybridizing:   6%|▌         | 53/862 [00:01<00:15, 50.67it/s]
Hybridizing:   7%|▋         | 59/862 [00:01<00:15, 50.64it/s]
Hybridizing:   8%|▊         | 65/862 [00:01<00:15, 50.68it/s]
Hybridizing:   8%|▊         | 71/862 [00:01<00:15, 50.68it/s]
Hybridizing:   9%|▉         | 77/862 [00:01<00:15, 49.14it/s]
Hybridizing:  10%|▉         | 83/862 [00:01<00:15, 49.59it/s]
Hybridizing:  10%|█         | 89/862 [00:01<00:15, 49.91it/s]
Hybridizing:  11%|█         | 94/862 [00:01<00:15, 48.45it/s]
Hybridizing:  12%|█▏        | 100/862 [00:02<00:15, 49.13it/s]
Hybridizing:  12%|█▏        | 106/862 [00:02<00:15, 49.62it/s]
Hybridizing:  13%|█▎        | 112/862 [00:02<00:15, 49.97it/s]
Hybridizing:  14%|█▎        | 118/862 [00:02<00:14, 50.21it/s]
Hybridizing:  14%|█▍        | 124/862 [00:02<00:14, 50.39it/s]
Hybridizing:  15%|█▌        | 130/862 [00:02<00:14, 50.54it/s]
Hybridizing:  16%|█▌        | 136/862 [00:02<00:14, 50.60it/s]
Hybridizing:  16%|█▋        | 142/862 [00:02<00:14, 50.49it/s]
Hybridizing:  17%|█▋        | 148/862 [00:02<00:14, 50.63it/s]
Hybridizing:  18%|█▊        | 154/862 [00:03<00:13, 50.74it/s]
Hybridizing:  19%|█▊        | 160/862 [00:03<00:13, 50.76it/s]
Hybridizing:  19%|█▉        | 166/862 [00:03<00:13, 50.81it/s]
Hybridizing:  20%|█▉        | 172/862 [00:03<00:13, 50.88it/s]
Hybridizing:  21%|██        | 178/862 [00:03<00:13, 49.14it/s]
Hybridizing:  21%|██▏       | 184/862 [00:03<00:13, 49.68it/s]
Hybridizing:  22%|██▏       | 190/862 [00:03<00:13, 50.07it/s]
Hybridizing:  23%|██▎       | 196/862 [00:03<00:13, 48.78it/s]
Hybridizing:  23%|██▎       | 202/862 [00:04<00:13, 49.37it/s]
Hybridizing:  24%|██▍       | 208/862 [00:04<00:13, 49.84it/s]
Hybridizing:  25%|██▍       | 214/862 [00:04<00:12, 50.15it/s]
Hybridizing:  26%|██▌       | 220/862 [00:04<00:12, 50.36it/s]
Hybridizing:  26%|██▌       | 226/862 [00:04<00:12, 50.52it/s]
Hybridizing:  27%|██▋       | 232/862 [00:04<00:12, 50.65it/s]
Hybridizing:  28%|██▊       | 238/862 [00:04<00:12, 50.75it/s]
Hybridizing:  28%|██▊       | 244/862 [00:04<00:12, 50.82it/s]
Hybridizing:  29%|██▉       | 250/862 [00:04<00:12, 50.84it/s]
Hybridizing:  30%|██▉       | 256/862 [00:05<00:11, 50.82it/s]
Hybridizing:  30%|███       | 262/862 [00:05<00:11, 50.55it/s]
Hybridizing:  31%|███       | 268/862 [00:05<00:12, 48.83it/s]
Hybridizing:  32%|███▏      | 273/862 [00:05<00:12, 47.51it/s]
Hybridizing:  32%|███▏      | 279/862 [00:05<00:12, 48.41it/s]
Hybridizing:  33%|███▎      | 285/862 [00:05<00:11, 48.96it/s]
Hybridizing:  34%|███▍      | 291/862 [00:05<00:11, 49.41it/s]
Hybridizing:  34%|███▍      | 297/862 [00:05<00:11, 49.64it/s]
Hybridizing:  35%|███▌      | 303/862 [00:06<00:11, 49.84it/s]
Hybridizing:  36%|███▌      | 309/862 [00:06<00:11, 49.98it/s]
Hybridizing:  37%|███▋      | 315/862 [00:06<00:10, 50.17it/s]
Hybridizing:  37%|███▋      | 321/862 [00:06<00:10, 50.19it/s]
Hybridizing:  38%|███▊      | 327/862 [00:06<00:10, 50.32it/s]
Hybridizing:  39%|███▊      | 333/862 [00:06<00:10, 50.32it/s]
Hybridizing:  39%|███▉      | 339/862 [00:06<00:10, 50.39it/s]
Hybridizing:  40%|████      | 345/862 [00:06<00:10, 50.36it/s]
Hybridizing:  41%|████      | 351/862 [00:07<00:10, 50.43it/s]
Hybridizing:  41%|████▏     | 357/862 [00:07<00:10, 48.87it/s]
Hybridizing:  42%|████▏     | 363/862 [00:07<00:10, 49.35it/s]
Hybridizing:  43%|████▎     | 369/862 [00:07<00:09, 49.61it/s]
Hybridizing:  44%|████▎     | 375/862 [00:07<00:09, 49.77it/s]
Hybridizing:  44%|████▍     | 381/862 [00:07<00:09, 49.92it/s]
Hybridizing:  45%|████▍     | 387/862 [00:07<00:09, 50.06it/s]
Hybridizing:  46%|████▌     | 393/862 [00:07<00:09, 50.12it/s]
Hybridizing:  46%|████▋     | 399/862 [00:07<00:09, 50.22it/s]
Hybridizing:  47%|████▋     | 405/862 [00:08<00:09, 50.21it/s]
Hybridizing:  48%|████▊     | 411/862 [00:08<00:08, 50.33it/s]
Hybridizing:  48%|████▊     | 417/862 [00:08<00:09, 49.09it/s]
Hybridizing:  49%|████▉     | 422/862 [00:08<00:08, 49.02it/s]
Hybridizing:  50%|████▉     | 427/862 [00:08<00:09, 47.53it/s]
Hybridizing:  50%|█████     | 433/862 [00:08<00:08, 48.48it/s]
Hybridizing:  51%|█████     | 439/862 [00:08<00:08, 49.10it/s]
Hybridizing:  52%|█████▏    | 445/862 [00:08<00:08, 49.56it/s]
Hybridizing:  52%|█████▏    | 451/862 [00:09<00:08, 49.87it/s]
Hybridizing:  53%|█████▎    | 457/862 [00:09<00:08, 50.10it/s]
Hybridizing:  54%|█████▎    | 463/862 [00:09<00:07, 50.25it/s]
Hybridizing:  54%|█████▍    | 469/862 [00:09<00:07, 50.35it/s]
Hybridizing:  55%|█████▌    | 475/862 [00:09<00:07, 50.37it/s]
Hybridizing:  56%|█████▌    | 481/862 [00:09<00:07, 50.45it/s]
Hybridizing:  56%|█████▋    | 487/862 [00:09<00:07, 50.48it/s]
Hybridizing:  57%|█████▋    | 493/862 [00:09<00:07, 50.52it/s]
Hybridizing:  58%|█████▊    | 499/862 [00:09<00:07, 50.55it/s]
Hybridizing:  59%|█████▊    | 505/862 [00:10<00:07, 49.02it/s]
Hybridizing:  59%|█████▉    | 511/862 [00:10<00:07, 49.43it/s]
Hybridizing:  60%|█████▉    | 517/862 [00:10<00:06, 49.76it/s]
Hybridizing:  61%|██████    | 522/862 [00:10<00:07, 48.38it/s]
Hybridizing:  61%|██████▏   | 528/862 [00:10<00:06, 48.94it/s]
Hybridizing:  62%|██████▏   | 534/862 [00:10<00:06, 49.39it/s]
Hybridizing:  63%|██████▎   | 540/862 [00:10<00:06, 49.67it/s]
Hybridizing:  63%|██████▎   | 546/862 [00:10<00:06, 49.92it/s]
Hybridizing:  64%|██████▍   | 552/862 [00:11<00:06, 50.03it/s]
Hybridizing:  65%|██████▍   | 558/862 [00:11<00:06, 50.12it/s]
Hybridizing:  65%|██████▌   | 564/862 [00:11<00:05, 50.13it/s]
Hybridizing:  66%|██████▌   | 570/862 [00:11<00:05, 50.25it/s]
Hybridizing:  67%|██████▋   | 576/862 [00:11<00:05, 50.22it/s]
Hybridizing:  68%|██████▊   | 582/862 [00:11<00:05, 50.31it/s]
Hybridizing:  68%|██████▊   | 588/862 [00:11<00:05, 50.28it/s]
Hybridizing:  69%|██████▉   | 594/862 [00:11<00:05, 49.98it/s]
Hybridizing:  70%|██████▉   | 600/862 [00:12<00:05, 50.07it/s]
Hybridizing:  70%|███████   | 606/862 [00:12<00:05, 48.56it/s]
Hybridizing:  71%|███████   | 612/862 [00:12<00:05, 49.06it/s]
Hybridizing:  72%|███████▏  | 618/862 [00:12<00:04, 49.52it/s]
Hybridizing:  72%|███████▏  | 623/862 [00:12<00:04, 48.01it/s]
Hybridizing:  73%|███████▎  | 629/862 [00:12<00:04, 48.75it/s]
Hybridizing:  74%|███████▎  | 635/862 [00:12<00:04, 49.22it/s]
Hybridizing:  74%|███████▍  | 641/862 [00:12<00:04, 49.59it/s]
Hybridizing:  75%|███████▌  | 647/862 [00:12<00:04, 49.80it/s]
Hybridizing:  76%|███████▌  | 653/862 [00:13<00:04, 50.00it/s]
Hybridizing:  76%|███████▋  | 659/862 [00:13<00:04, 50.13it/s]
Hybridizing:  77%|███████▋  | 665/862 [00:13<00:03, 50.27it/s]
Hybridizing:  78%|███████▊  | 671/862 [00:13<00:03, 50.27it/s]
Hybridizing:  79%|███████▊  | 677/862 [00:13<00:03, 50.34it/s]
Hybridizing:  79%|███████▉  | 683/862 [00:13<00:03, 50.35it/s]
Hybridizing:  80%|███████▉  | 689/862 [00:13<00:03, 50.43it/s]
Hybridizing:  81%|████████  | 695/862 [00:13<00:03, 49.35it/s]
Hybridizing:  81%|████████  | 700/862 [00:14<00:03, 49.04it/s]
Hybridizing:  82%|████████▏ | 705/862 [00:14<00:03, 47.80it/s]
Hybridizing:  82%|████████▏ | 711/862 [00:14<00:03, 48.52it/s]
Hybridizing:  83%|████████▎ | 717/862 [00:14<00:02, 49.13it/s]
Hybridizing:  84%|████████▍ | 723/862 [00:14<00:02, 49.57it/s]
Hybridizing:  85%|████████▍ | 729/862 [00:14<00:02, 49.88it/s]
Hybridizing:  85%|████████▌ | 734/862 [00:14<00:02, 49.70it/s]
Hybridizing:  86%|████████▌ | 740/862 [00:14<00:02, 49.83it/s]
Hybridizing:  87%|████████▋ | 746/862 [00:14<00:02, 50.04it/s]
Hybridizing:  87%|████████▋ | 752/862 [00:15<00:02, 50.12it/s]
Hybridizing:  88%|████████▊ | 758/862 [00:15<00:02, 50.26it/s]
Hybridizing:  89%|████████▊ | 764/862 [00:15<00:01, 50.21it/s]
Hybridizing:  89%|████████▉ | 770/862 [00:15<00:01, 50.26it/s]
Hybridizing:  90%|█████████ | 776/862 [00:15<00:01, 48.73it/s]
Hybridizing:  91%|█████████ | 782/862 [00:15<00:01, 49.26it/s]
Hybridizing:  91%|█████████▏| 787/862 [00:15<00:01, 47.84it/s]
Hybridizing:  92%|█████████▏| 793/862 [00:15<00:01, 48.62it/s]
Hybridizing:  93%|█████████▎| 799/862 [00:16<00:01, 49.08it/s]
Hybridizing:  93%|█████████▎| 805/862 [00:16<00:01, 49.46it/s]
Hybridizing:  94%|█████████▍| 811/862 [00:16<00:01, 49.67it/s]
Hybridizing:  95%|█████████▍| 817/862 [00:16<00:00, 49.92it/s]
Hybridizing:  95%|█████████▌| 823/862 [00:16<00:00, 50.03it/s]
Hybridizing:  96%|█████████▌| 829/862 [00:16<00:00, 50.15it/s]
Hybridizing:  97%|█████████▋| 835/862 [00:16<00:00, 50.19it/s]
Hybridizing:  98%|█████████▊| 841/862 [00:16<00:00, 50.28it/s]
Hybridizing:  98%|█████████▊| 847/862 [00:17<00:00, 50.24it/s]
Hybridizing:  99%|█████████▉| 853/862 [00:17<00:00, 48.71it/s]
Hybridizing: 100%|█████████▉| 858/862 [00:17<00:00, 47.74it/s]
Hybridizing: 100%|██████████| 862/862 [00:17<00:00, 49.74it/s]

0it [00:00, ?it/s]
32it [00:00, 298.44it/s]
64it [00:00, 300.62it/s]
96it [00:00, 302.00it/s]
128it [00:00, 298.49it/s]
160it [00:00, 299.46it/s]
192it [00:00, 300.31it/s]
224it [00:00, 300.91it/s]
256it [00:00, 301.55it/s]
288it [00:00, 302.22it/s]
320it [00:01, 302.49it/s]
352it [00:01, 301.44it/s]
384it [00:01, 301.68it/s]
416it [00:01, 290.97it/s]
448it [00:01, 293.93it/s]
480it [00:01, 296.72it/s]
512it [00:01, 290.34it/s]
544it [00:01, 292.96it/s]
576it [00:01, 296.42it/s]
608it [00:02, 297.89it/s]
640it [00:02, 299.39it/s]
672it [00:02, 299.75it/s]
704it [00:02, 301.25it/s]
736it [00:02, 301.64it/s]
768it [00:02, 301.64it/s]
800it [00:02, 301.93it/s]
832it [00:02, 302.35it/s]
862it [00:02, 299.32it/s]
