[2025-11-19 12:10:04,906][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:10:04,907][datasets][INFO] - JAX version 0.6.1 available.
Hybrid Evaluation Configuration:
  Base model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading base model...
Loading preconditioned model...
Generating base model predictions...
Generating preconditioned model predictions...
Generated 2304 forecast pairs
Extracting input windows from test data...
Extracted 2304 input windows
Creating hybrid forecasts...
Created 2304 hybrid forecasts
Computing metrics...


Base model:   0%|          | 0/2304 [00:00<?, ?it/s]
Base model:   0%|          | 1/2304 [00:00<10:04,  3.81it/s]
Base model:   7%|▋         | 161/2304 [00:00<00:03, 554.68it/s]
Base model:  14%|█▍        | 321/2304 [00:00<00:02, 888.02it/s]
Base model:  21%|██        | 481/2304 [00:00<00:01, 1106.88it/s]
Base model:  28%|██▊       | 641/2304 [00:00<00:01, 1208.53it/s]
Base model:  35%|███▍      | 801/2304 [00:00<00:01, 1301.45it/s]
Base model:  42%|████▏     | 961/2304 [00:00<00:00, 1370.55it/s]
Base model:  49%|████▊     | 1121/2304 [00:01<00:00, 1417.57it/s]
Base model:  56%|█████▌    | 1281/2304 [00:01<00:00, 1404.49it/s]
Base model:  63%|██████▎   | 1441/2304 [00:01<00:00, 1440.47it/s]
Base model:  69%|██████▉   | 1601/2304 [00:01<00:00, 1479.81it/s]
Base model:  76%|███████▋  | 1761/2304 [00:01<00:00, 1491.83it/s]
Base model:  83%|████████▎ | 1921/2304 [00:01<00:00, 1500.15it/s]
Base model:  90%|█████████ | 2081/2304 [00:01<00:00, 1508.10it/s]
Base model:  97%|█████████▋| 2241/2304 [00:01<00:00, 1513.09it/s]
Base model: 100%|██████████| 2304/2304 [00:01<00:00, 1302.84it/s]

Precond model:   0%|          | 0/2304 [00:00<?, ?it/s]
Precond model:   6%|▌         | 129/2304 [00:00<00:01, 1175.23it/s]
Precond model:  13%|█▎        | 289/2304 [00:00<00:01, 1341.32it/s]
Precond model:  19%|█▉        | 449/2304 [00:00<00:01, 1400.50it/s]
Precond model:  26%|██▋       | 609/2304 [00:00<00:01, 1437.24it/s]
Precond model:  33%|███▎      | 769/2304 [00:00<00:01, 1444.49it/s]
Precond model:  40%|████      | 929/2304 [00:00<00:00, 1409.73it/s]
Precond model:  47%|████▋     | 1089/2304 [00:00<00:00, 1418.32it/s]
Precond model:  54%|█████▍    | 1249/2304 [00:00<00:00, 1391.33it/s]
Precond model:  61%|██████    | 1409/2304 [00:01<00:00, 1411.29it/s]
Precond model:  68%|██████▊   | 1569/2304 [00:01<00:00, 1425.24it/s]
Precond model:  75%|███████▌  | 1729/2304 [00:01<00:00, 1441.23it/s]
Precond model:  82%|████████▏ | 1889/2304 [00:01<00:00, 1442.54it/s]
Precond model:  89%|████████▉ | 2049/2304 [00:01<00:00, 1445.88it/s]
Precond model:  96%|█████████▌| 2209/2304 [00:01<00:00, 1445.25it/s]
Precond model: 100%|██████████| 2304/2304 [00:01<00:00, 1441.21it/s]

Hybridizing:   0%|          | 0/2304 [00:00<?, ?it/s]
Hybridizing:   0%|          | 6/2304 [00:00<00:44, 51.18it/s]
Hybridizing:   1%|          | 12/2304 [00:00<00:44, 51.23it/s]
Hybridizing:   1%|          | 18/2304 [00:00<00:44, 51.21it/s]
Hybridizing:   1%|          | 24/2304 [00:00<00:44, 51.23it/s]
Hybridizing:   1%|▏         | 30/2304 [00:00<00:44, 51.22it/s]
Hybridizing:   2%|▏         | 36/2304 [00:00<00:46, 49.26it/s]
Hybridizing:   2%|▏         | 42/2304 [00:00<00:45, 49.86it/s]
Hybridizing:   2%|▏         | 47/2304 [00:00<00:46, 48.55it/s]
Hybridizing:   2%|▏         | 53/2304 [00:01<00:45, 49.31it/s]
Hybridizing:   3%|▎         | 59/2304 [00:01<00:44, 49.90it/s]
Hybridizing:   3%|▎         | 65/2304 [00:01<00:44, 50.31it/s]
Hybridizing:   3%|▎         | 71/2304 [00:01<00:44, 50.61it/s]
Hybridizing:   3%|▎         | 77/2304 [00:01<00:43, 50.78it/s]
Hybridizing:   4%|▎         | 83/2304 [00:01<00:43, 50.95it/s]
Hybridizing:   4%|▍         | 89/2304 [00:01<00:43, 51.05it/s]
Hybridizing:   4%|▍         | 95/2304 [00:01<00:43, 51.05it/s]
Hybridizing:   4%|▍         | 101/2304 [00:01<00:43, 51.08it/s]
Hybridizing:   5%|▍         | 107/2304 [00:02<00:43, 51.07it/s]
Hybridizing:   5%|▍         | 113/2304 [00:02<00:42, 51.05it/s]
Hybridizing:   5%|▌         | 119/2304 [00:02<00:44, 49.41it/s]
Hybridizing:   5%|▌         | 124/2304 [00:02<00:45, 48.05it/s]
Hybridizing:   6%|▌         | 130/2304 [00:02<00:44, 49.04it/s]
Hybridizing:   6%|▌         | 136/2304 [00:02<00:43, 49.72it/s]
Hybridizing:   6%|▌         | 142/2304 [00:02<00:43, 50.20it/s]
Hybridizing:   6%|▋         | 148/2304 [00:02<00:42, 50.53it/s]
Hybridizing:   7%|▋         | 154/2304 [00:03<00:42, 50.72it/s]
Hybridizing:   7%|▋         | 160/2304 [00:03<00:42, 50.92it/s]
Hybridizing:   7%|▋         | 166/2304 [00:03<00:41, 50.98it/s]
Hybridizing:   7%|▋         | 172/2304 [00:03<00:41, 51.11it/s]
Hybridizing:   8%|▊         | 178/2304 [00:03<00:41, 51.16it/s]
Hybridizing:   8%|▊         | 184/2304 [00:03<00:41, 51.17it/s]
Hybridizing:   8%|▊         | 190/2304 [00:03<00:42, 49.72it/s]
Hybridizing:   9%|▊         | 196/2304 [00:03<00:42, 50.19it/s]
Hybridizing:   9%|▉         | 202/2304 [00:04<00:43, 48.83it/s]
Hybridizing:   9%|▉         | 208/2304 [00:04<00:42, 49.54it/s]
Hybridizing:   9%|▉         | 214/2304 [00:04<00:41, 50.07it/s]
Hybridizing:  10%|▉         | 220/2304 [00:04<00:41, 50.45it/s]
Hybridizing:  10%|▉         | 226/2304 [00:04<00:40, 50.70it/s]
Hybridizing:  10%|█         | 232/2304 [00:04<00:40, 50.88it/s]
Hybridizing:  10%|█         | 238/2304 [00:04<00:40, 51.00it/s]
Hybridizing:  11%|█         | 244/2304 [00:04<00:40, 51.09it/s]
Hybridizing:  11%|█         | 250/2304 [00:04<00:40, 51.19it/s]
Hybridizing:  11%|█         | 256/2304 [00:05<00:39, 51.21it/s]
Hybridizing:  11%|█▏        | 262/2304 [00:05<00:39, 51.22it/s]
Hybridizing:  12%|█▏        | 268/2304 [00:05<00:39, 51.39it/s]
Hybridizing:  12%|█▏        | 274/2304 [00:05<00:39, 51.53it/s]
Hybridizing:  12%|█▏        | 280/2304 [00:05<00:39, 51.65it/s]
Hybridizing:  12%|█▏        | 286/2304 [00:05<00:40, 50.10it/s]
Hybridizing:  13%|█▎        | 292/2304 [00:05<00:39, 50.61it/s]
Hybridizing:  13%|█▎        | 298/2304 [00:05<00:39, 50.98it/s]
Hybridizing:  13%|█▎        | 304/2304 [00:06<00:39, 51.24it/s]
Hybridizing:  13%|█▎        | 310/2304 [00:06<00:40, 49.77it/s]
Hybridizing:  14%|█▎        | 316/2304 [00:06<00:39, 50.30it/s]
Hybridizing:  14%|█▍        | 322/2304 [00:06<00:39, 50.70it/s]
Hybridizing:  14%|█▍        | 328/2304 [00:06<00:38, 50.96it/s]
Hybridizing:  14%|█▍        | 334/2304 [00:06<00:38, 51.20it/s]
Hybridizing:  15%|█▍        | 340/2304 [00:06<00:38, 51.33it/s]
Hybridizing:  15%|█▌        | 346/2304 [00:06<00:38, 51.46it/s]
Hybridizing:  15%|█▌        | 352/2304 [00:06<00:37, 51.58it/s]
Hybridizing:  16%|█▌        | 358/2304 [00:07<00:37, 51.61it/s]
Hybridizing:  16%|█▌        | 364/2304 [00:07<00:37, 51.67it/s]
Hybridizing:  16%|█▌        | 370/2304 [00:07<00:37, 51.72it/s]
Hybridizing:  16%|█▋        | 376/2304 [00:07<00:37, 51.77it/s]
Hybridizing:  17%|█▋        | 382/2304 [00:07<00:38, 50.21it/s]
Hybridizing:  17%|█▋        | 388/2304 [00:07<00:39, 48.65it/s]
Hybridizing:  17%|█▋        | 394/2304 [00:07<00:38, 49.54it/s]
Hybridizing:  17%|█▋        | 400/2304 [00:07<00:37, 50.20it/s]
Hybridizing:  18%|█▊        | 406/2304 [00:08<00:37, 50.69it/s]
Hybridizing:  18%|█▊        | 412/2304 [00:08<00:37, 51.01it/s]
Hybridizing:  18%|█▊        | 418/2304 [00:08<00:36, 51.26it/s]
Hybridizing:  18%|█▊        | 424/2304 [00:08<00:36, 51.46it/s]
Hybridizing:  19%|█▊        | 430/2304 [00:08<00:36, 51.59it/s]
Hybridizing:  19%|█▉        | 436/2304 [00:08<00:36, 51.65it/s]
Hybridizing:  19%|█▉        | 442/2304 [00:08<00:36, 51.70it/s]
Hybridizing:  19%|█▉        | 448/2304 [00:08<00:35, 51.76it/s]
Hybridizing:  20%|█▉        | 454/2304 [00:08<00:35, 51.81it/s]
Hybridizing:  20%|█▉        | 460/2304 [00:09<00:36, 50.17it/s]
Hybridizing:  20%|██        | 466/2304 [00:09<00:36, 50.68it/s]
Hybridizing:  20%|██        | 472/2304 [00:09<00:37, 49.38it/s]
Hybridizing:  21%|██        | 478/2304 [00:09<00:36, 50.12it/s]
Hybridizing:  21%|██        | 484/2304 [00:09<00:35, 50.64it/s]
Hybridizing:  21%|██▏       | 490/2304 [00:09<00:35, 50.99it/s]
Hybridizing:  22%|██▏       | 496/2304 [00:09<00:35, 51.25it/s]
Hybridizing:  22%|██▏       | 502/2304 [00:09<00:35, 51.45it/s]
Hybridizing:  22%|██▏       | 508/2304 [00:10<00:34, 51.57it/s]
Hybridizing:  22%|██▏       | 514/2304 [00:10<00:34, 51.64it/s]
Hybridizing:  23%|██▎       | 520/2304 [00:10<00:34, 51.68it/s]
Hybridizing:  23%|██▎       | 526/2304 [00:10<00:34, 51.74it/s]
Hybridizing:  23%|██▎       | 532/2304 [00:10<00:34, 51.77it/s]
Hybridizing:  23%|██▎       | 538/2304 [00:10<00:35, 50.08it/s]
Hybridizing:  24%|██▎       | 544/2304 [00:10<00:34, 50.55it/s]
Hybridizing:  24%|██▍       | 550/2304 [00:10<00:35, 49.35it/s]
Hybridizing:  24%|██▍       | 556/2304 [00:10<00:34, 50.02it/s]
Hybridizing:  24%|██▍       | 562/2304 [00:11<00:34, 50.14it/s]
Hybridizing:  25%|██▍       | 568/2304 [00:11<00:34, 50.60it/s]
Hybridizing:  25%|██▍       | 574/2304 [00:11<00:33, 50.96it/s]
Hybridizing:  25%|██▌       | 580/2304 [00:11<00:33, 51.13it/s]
Hybridizing:  25%|██▌       | 586/2304 [00:11<00:33, 51.29it/s]
Hybridizing:  26%|██▌       | 592/2304 [00:11<00:33, 51.39it/s]
Hybridizing:  26%|██▌       | 598/2304 [00:11<00:33, 51.45it/s]
Hybridizing:  26%|██▌       | 604/2304 [00:11<00:32, 51.52it/s]
Hybridizing:  26%|██▋       | 610/2304 [00:12<00:32, 51.59it/s]
Hybridizing:  27%|██▋       | 616/2304 [00:12<00:33, 49.88it/s]
Hybridizing:  27%|██▋       | 622/2304 [00:12<00:34, 48.72it/s]
Hybridizing:  27%|██▋       | 628/2304 [00:12<00:33, 49.48it/s]
Hybridizing:  28%|██▊       | 634/2304 [00:12<00:33, 50.14it/s]
Hybridizing:  28%|██▊       | 640/2304 [00:12<00:32, 50.61it/s]
Hybridizing:  28%|██▊       | 646/2304 [00:12<00:32, 50.96it/s]
Hybridizing:  28%|██▊       | 652/2304 [00:12<00:32, 51.20it/s]
Hybridizing:  29%|██▊       | 658/2304 [00:12<00:32, 51.40it/s]
Hybridizing:  29%|██▉       | 664/2304 [00:13<00:31, 51.49it/s]
Hybridizing:  29%|██▉       | 670/2304 [00:13<00:31, 51.57it/s]
Hybridizing:  29%|██▉       | 676/2304 [00:13<00:31, 51.64it/s]
Hybridizing:  30%|██▉       | 682/2304 [00:13<00:31, 51.71it/s]
Hybridizing:  30%|██▉       | 688/2304 [00:13<00:31, 51.73it/s]
Hybridizing:  30%|███       | 694/2304 [00:13<00:32, 50.04it/s]
Hybridizing:  30%|███       | 700/2304 [00:13<00:31, 50.54it/s]
Hybridizing:  31%|███       | 706/2304 [00:13<00:31, 50.95it/s]
Hybridizing:  31%|███       | 712/2304 [00:14<00:31, 51.21it/s]
Hybridizing:  31%|███       | 718/2304 [00:14<00:31, 49.70it/s]
Hybridizing:  31%|███▏      | 724/2304 [00:14<00:31, 50.28it/s]
Hybridizing:  32%|███▏      | 730/2304 [00:14<00:31, 50.76it/s]
Hybridizing:  32%|███▏      | 736/2304 [00:14<00:31, 50.55it/s]
Hybridizing:  32%|███▏      | 742/2304 [00:14<00:30, 50.93it/s]
Hybridizing:  32%|███▏      | 748/2304 [00:14<00:30, 51.19it/s]
Hybridizing:  33%|███▎      | 754/2304 [00:14<00:30, 51.34it/s]
Hybridizing:  33%|███▎      | 760/2304 [00:14<00:30, 51.44it/s]
Hybridizing:  33%|███▎      | 766/2304 [00:15<00:29, 51.54it/s]
Hybridizing:  34%|███▎      | 772/2304 [00:15<00:29, 51.61it/s]
Hybridizing:  34%|███▍      | 778/2304 [00:15<00:29, 51.68it/s]
Hybridizing:  34%|███▍      | 784/2304 [00:15<00:29, 51.69it/s]
Hybridizing:  34%|███▍      | 790/2304 [00:15<00:30, 49.98it/s]
Hybridizing:  35%|███▍      | 796/2304 [00:15<00:30, 48.81it/s]
Hybridizing:  35%|███▍      | 802/2304 [00:15<00:30, 49.65it/s]
Hybridizing:  35%|███▌      | 808/2304 [00:15<00:29, 50.27it/s]
Hybridizing:  35%|███▌      | 814/2304 [00:16<00:29, 50.72it/s]
Hybridizing:  36%|███▌      | 820/2304 [00:16<00:29, 51.00it/s]
Hybridizing:  36%|███▌      | 826/2304 [00:16<00:28, 51.24it/s]
Hybridizing:  36%|███▌      | 832/2304 [00:16<00:28, 51.41it/s]
Hybridizing:  36%|███▋      | 838/2304 [00:16<00:28, 51.51it/s]
Hybridizing:  37%|███▋      | 844/2304 [00:16<00:28, 51.58it/s]
Hybridizing:  37%|███▋      | 850/2304 [00:16<00:28, 51.59it/s]
Hybridizing:  37%|███▋      | 856/2304 [00:16<00:28, 51.64it/s]
Hybridizing:  37%|███▋      | 862/2304 [00:16<00:28, 49.99it/s]
Hybridizing:  38%|███▊      | 868/2304 [00:17<00:28, 50.50it/s]
Hybridizing:  38%|███▊      | 874/2304 [00:17<00:29, 49.23it/s]
Hybridizing:  38%|███▊      | 880/2304 [00:17<00:28, 49.95it/s]
Hybridizing:  38%|███▊      | 886/2304 [00:17<00:28, 50.40it/s]
Hybridizing:  39%|███▊      | 892/2304 [00:17<00:27, 50.73it/s]
Hybridizing:  39%|███▉      | 898/2304 [00:17<00:27, 51.00it/s]
Hybridizing:  39%|███▉      | 904/2304 [00:17<00:27, 51.15it/s]
Hybridizing:  39%|███▉      | 910/2304 [00:17<00:27, 51.29it/s]
Hybridizing:  40%|███▉      | 916/2304 [00:18<00:27, 51.36it/s]
Hybridizing:  40%|████      | 922/2304 [00:18<00:26, 51.40it/s]
Hybridizing:  40%|████      | 928/2304 [00:18<00:26, 51.42it/s]
Hybridizing:  41%|████      | 934/2304 [00:18<00:26, 51.46it/s]
Hybridizing:  41%|████      | 940/2304 [00:18<00:27, 49.95it/s]
Hybridizing:  41%|████      | 946/2304 [00:18<00:26, 50.45it/s]
Hybridizing:  41%|████▏     | 952/2304 [00:18<00:27, 49.65it/s]
Hybridizing:  42%|████▏     | 957/2304 [00:18<00:27, 49.64it/s]
Hybridizing:  42%|████▏     | 963/2304 [00:18<00:26, 50.35it/s]
Hybridizing:  42%|████▏     | 969/2304 [00:19<00:26, 50.69it/s]
Hybridizing:  42%|████▏     | 975/2304 [00:19<00:25, 51.12it/s]
Hybridizing:  43%|████▎     | 981/2304 [00:19<00:25, 51.30it/s]
Hybridizing:  43%|████▎     | 987/2304 [00:19<00:25, 51.57it/s]
Hybridizing:  43%|████▎     | 993/2304 [00:19<00:25, 51.64it/s]
Hybridizing:  43%|████▎     | 999/2304 [00:19<00:25, 51.80it/s]
Hybridizing:  44%|████▎     | 1005/2304 [00:19<00:25, 51.78it/s]
Hybridizing:  44%|████▍     | 1011/2304 [00:19<00:24, 51.87it/s]
Hybridizing:  44%|████▍     | 1017/2304 [00:20<00:24, 51.87it/s]
Hybridizing:  44%|████▍     | 1023/2304 [00:20<00:25, 50.19it/s]
Hybridizing:  45%|████▍     | 1029/2304 [00:20<00:25, 49.10it/s]
Hybridizing:  45%|████▍     | 1035/2304 [00:20<00:25, 49.94it/s]
Hybridizing:  45%|████▌     | 1041/2304 [00:20<00:25, 50.47it/s]
Hybridizing:  45%|████▌     | 1047/2304 [00:20<00:24, 50.97it/s]
Hybridizing:  46%|████▌     | 1053/2304 [00:20<00:24, 51.22it/s]
Hybridizing:  46%|████▌     | 1059/2304 [00:20<00:24, 51.49it/s]
Hybridizing:  46%|████▌     | 1065/2304 [00:20<00:24, 51.58it/s]
Hybridizing:  46%|████▋     | 1071/2304 [00:21<00:23, 51.75it/s]
Hybridizing:  47%|████▋     | 1077/2304 [00:21<00:23, 51.80it/s]
Hybridizing:  47%|████▋     | 1083/2304 [00:21<00:23, 51.92it/s]
Hybridizing:  47%|████▋     | 1089/2304 [00:21<00:23, 51.30it/s]
Hybridizing:  48%|████▊     | 1095/2304 [00:21<00:23, 51.53it/s]
Hybridizing:  48%|████▊     | 1101/2304 [00:21<00:23, 51.59it/s]
Hybridizing:  48%|████▊     | 1107/2304 [00:21<00:23, 51.70it/s]
Hybridizing:  48%|████▊     | 1113/2304 [00:21<00:23, 49.95it/s]
Hybridizing:  49%|████▊     | 1119/2304 [00:22<00:23, 50.56it/s]
Hybridizing:  49%|████▉     | 1125/2304 [00:22<00:23, 50.94it/s]
Hybridizing:  49%|████▉     | 1131/2304 [00:22<00:23, 49.68it/s]
Hybridizing:  49%|████▉     | 1137/2304 [00:22<00:23, 50.28it/s]
Hybridizing:  50%|████▉     | 1143/2304 [00:22<00:22, 50.79it/s]
Hybridizing:  50%|████▉     | 1149/2304 [00:22<00:22, 51.08it/s]
Hybridizing:  50%|█████     | 1155/2304 [00:22<00:22, 51.37it/s]
Hybridizing:  50%|█████     | 1161/2304 [00:22<00:22, 51.49it/s]
Hybridizing:  51%|█████     | 1167/2304 [00:22<00:22, 51.66it/s]
Hybridizing:  51%|█████     | 1173/2304 [00:23<00:21, 51.65it/s]
Hybridizing:  51%|█████     | 1179/2304 [00:23<00:21, 51.76it/s]
Hybridizing:  51%|█████▏    | 1185/2304 [00:23<00:21, 51.74it/s]
Hybridizing:  52%|█████▏    | 1191/2304 [00:23<00:21, 51.85it/s]
Hybridizing:  52%|█████▏    | 1197/2304 [00:23<00:21, 51.78it/s]
Hybridizing:  52%|█████▏    | 1203/2304 [00:23<00:21, 50.13it/s]
Hybridizing:  52%|█████▏    | 1209/2304 [00:23<00:22, 48.95it/s]
Hybridizing:  53%|█████▎    | 1215/2304 [00:23<00:21, 49.83it/s]
Hybridizing:  53%|█████▎    | 1221/2304 [00:24<00:21, 50.38it/s]
Hybridizing:  53%|█████▎    | 1227/2304 [00:24<00:21, 50.83it/s]
Hybridizing:  54%|█████▎    | 1233/2304 [00:24<00:20, 51.06it/s]
Hybridizing:  54%|█████▍    | 1239/2304 [00:24<00:20, 51.31it/s]
Hybridizing:  54%|█████▍    | 1245/2304 [00:24<00:20, 51.40it/s]
Hybridizing:  54%|█████▍    | 1251/2304 [00:24<00:20, 51.57it/s]
Hybridizing:  55%|█████▍    | 1257/2304 [00:24<00:20, 51.56it/s]
Hybridizing:  55%|█████▍    | 1263/2304 [00:24<00:20, 51.52it/s]
Hybridizing:  55%|█████▌    | 1269/2304 [00:24<00:20, 51.55it/s]
Hybridizing:  55%|█████▌    | 1275/2304 [00:25<00:20, 49.88it/s]
Hybridizing:  56%|█████▌    | 1281/2304 [00:25<00:20, 50.38it/s]
Hybridizing:  56%|█████▌    | 1287/2304 [00:25<00:20, 49.14it/s]
Hybridizing:  56%|█████▌    | 1293/2304 [00:25<00:20, 49.84it/s]
Hybridizing:  56%|█████▋    | 1299/2304 [00:25<00:19, 50.40it/s]
Hybridizing:  57%|█████▋    | 1305/2304 [00:25<00:19, 50.76it/s]
Hybridizing:  57%|█████▋    | 1311/2304 [00:25<00:19, 51.11it/s]
Hybridizing:  57%|█████▋    | 1317/2304 [00:25<00:19, 51.28it/s]
Hybridizing:  57%|█████▋    | 1323/2304 [00:26<00:19, 51.50it/s]
Hybridizing:  58%|█████▊    | 1329/2304 [00:26<00:18, 51.56it/s]
Hybridizing:  58%|█████▊    | 1335/2304 [00:26<00:18, 51.66it/s]
Hybridizing:  58%|█████▊    | 1341/2304 [00:26<00:18, 51.70it/s]
Hybridizing:  58%|█████▊    | 1347/2304 [00:26<00:18, 51.78it/s]
Hybridizing:  59%|█████▊    | 1353/2304 [00:26<00:18, 51.75it/s]
Hybridizing:  59%|█████▉    | 1359/2304 [00:26<00:18, 50.08it/s]
Hybridizing:  59%|█████▉    | 1365/2304 [00:26<00:18, 49.67it/s]
Hybridizing:  59%|█████▉    | 1370/2304 [00:26<00:18, 49.57it/s]
Hybridizing:  60%|█████▉    | 1376/2304 [00:27<00:18, 50.20it/s]
Hybridizing:  60%|█████▉    | 1382/2304 [00:27<00:18, 50.76it/s]
Hybridizing:  60%|██████    | 1388/2304 [00:27<00:17, 51.00it/s]
Hybridizing:  61%|██████    | 1394/2304 [00:27<00:17, 51.31it/s]
Hybridizing:  61%|██████    | 1400/2304 [00:27<00:17, 51.41it/s]
Hybridizing:  61%|██████    | 1406/2304 [00:27<00:17, 51.63it/s]
Hybridizing:  61%|██████▏   | 1412/2304 [00:27<00:17, 51.65it/s]
Hybridizing:  62%|██████▏   | 1418/2304 [00:27<00:17, 51.78it/s]
Hybridizing:  62%|██████▏   | 1424/2304 [00:28<00:17, 51.76it/s]
Hybridizing:  62%|██████▏   | 1430/2304 [00:28<00:16, 51.87it/s]
Hybridizing:  62%|██████▏   | 1436/2304 [00:28<00:17, 49.82it/s]
Hybridizing:  63%|██████▎   | 1442/2304 [00:28<00:17, 48.75it/s]
Hybridizing:  63%|██████▎   | 1448/2304 [00:28<00:17, 49.55it/s]
Hybridizing:  63%|██████▎   | 1454/2304 [00:28<00:16, 50.27it/s]
Hybridizing:  63%|██████▎   | 1460/2304 [00:28<00:16, 50.69it/s]
Hybridizing:  64%|██████▎   | 1466/2304 [00:28<00:16, 51.06it/s]
Hybridizing:  64%|██████▍   | 1472/2304 [00:28<00:16, 51.28it/s]
Hybridizing:  64%|██████▍   | 1478/2304 [00:29<00:16, 51.49it/s]
Hybridizing:  64%|██████▍   | 1484/2304 [00:29<00:15, 51.57it/s]
Hybridizing:  65%|██████▍   | 1490/2304 [00:29<00:15, 51.73it/s]
Hybridizing:  65%|██████▍   | 1496/2304 [00:29<00:15, 51.71it/s]
Hybridizing:  65%|██████▌   | 1502/2304 [00:29<00:15, 51.80it/s]
Hybridizing:  65%|██████▌   | 1508/2304 [00:29<00:15, 51.76it/s]
Hybridizing:  66%|██████▌   | 1514/2304 [00:29<00:15, 51.87it/s]
Hybridizing:  66%|██████▌   | 1520/2304 [00:29<00:15, 51.82it/s]
Hybridizing:  66%|██████▌   | 1526/2304 [00:30<00:15, 50.27it/s]
Hybridizing:  66%|██████▋   | 1532/2304 [00:30<00:15, 50.68it/s]
Hybridizing:  67%|██████▋   | 1538/2304 [00:30<00:15, 51.07it/s]
Hybridizing:  67%|██████▋   | 1544/2304 [00:30<00:15, 49.73it/s]
Hybridizing:  67%|██████▋   | 1550/2304 [00:30<00:15, 50.13it/s]
Hybridizing:  68%|██████▊   | 1556/2304 [00:30<00:14, 50.45it/s]
Hybridizing:  68%|██████▊   | 1562/2304 [00:30<00:14, 50.77it/s]
Hybridizing:  68%|██████▊   | 1568/2304 [00:30<00:14, 50.90it/s]
Hybridizing:  68%|██████▊   | 1574/2304 [00:30<00:14, 51.04it/s]
Hybridizing:  69%|██████▊   | 1580/2304 [00:31<00:14, 51.11it/s]
Hybridizing:  69%|██████▉   | 1586/2304 [00:31<00:14, 51.19it/s]
Hybridizing:  69%|██████▉   | 1592/2304 [00:31<00:13, 51.19it/s]
Hybridizing:  69%|██████▉   | 1598/2304 [00:31<00:13, 51.21it/s]
Hybridizing:  70%|██████▉   | 1604/2304 [00:31<00:13, 51.21it/s]
Hybridizing:  70%|██████▉   | 1610/2304 [00:31<00:13, 51.26it/s]
Hybridizing:  70%|███████   | 1616/2304 [00:31<00:13, 49.79it/s]
Hybridizing:  70%|███████   | 1622/2304 [00:31<00:13, 50.23it/s]
Hybridizing:  71%|███████   | 1628/2304 [00:32<00:13, 48.96it/s]
Hybridizing:  71%|███████   | 1634/2304 [00:32<00:13, 49.69it/s]
Hybridizing:  71%|███████   | 1640/2304 [00:32<00:13, 50.13it/s]
Hybridizing:  71%|███████▏  | 1646/2304 [00:32<00:13, 50.47it/s]
Hybridizing:  72%|███████▏  | 1652/2304 [00:32<00:12, 50.68it/s]
Hybridizing:  72%|███████▏  | 1658/2304 [00:32<00:12, 50.89it/s]
Hybridizing:  72%|███████▏  | 1664/2304 [00:32<00:12, 51.01it/s]
Hybridizing:  72%|███████▏  | 1670/2304 [00:32<00:12, 51.08it/s]
Hybridizing:  73%|███████▎  | 1676/2304 [00:32<00:12, 51.11it/s]
Hybridizing:  73%|███████▎  | 1682/2304 [00:33<00:12, 51.21it/s]
Hybridizing:  73%|███████▎  | 1688/2304 [00:33<00:12, 51.16it/s]
Hybridizing:  74%|███████▎  | 1694/2304 [00:33<00:11, 51.23it/s]
Hybridizing:  74%|███████▍  | 1700/2304 [00:33<00:12, 49.34it/s]
Hybridizing:  74%|███████▍  | 1706/2304 [00:33<00:12, 48.54it/s]
Hybridizing:  74%|███████▍  | 1712/2304 [00:33<00:12, 49.33it/s]
Hybridizing:  75%|███████▍  | 1718/2304 [00:33<00:11, 49.91it/s]
Hybridizing:  75%|███████▍  | 1724/2304 [00:33<00:11, 50.30it/s]
Hybridizing:  75%|███████▌  | 1730/2304 [00:34<00:11, 50.62it/s]
Hybridizing:  75%|███████▌  | 1736/2304 [00:34<00:11, 50.80it/s]
Hybridizing:  76%|███████▌  | 1742/2304 [00:34<00:11, 50.94it/s]
Hybridizing:  76%|███████▌  | 1748/2304 [00:34<00:10, 51.00it/s]
Hybridizing:  76%|███████▌  | 1754/2304 [00:34<00:10, 51.15it/s]
Hybridizing:  76%|███████▋  | 1760/2304 [00:34<00:10, 51.18it/s]
Hybridizing:  77%|███████▋  | 1766/2304 [00:34<00:10, 51.22it/s]
Hybridizing:  77%|███████▋  | 1772/2304 [00:34<00:10, 49.70it/s]
Hybridizing:  77%|███████▋  | 1778/2304 [00:34<00:10, 50.19it/s]
Hybridizing:  77%|███████▋  | 1784/2304 [00:35<00:10, 48.85it/s]
Hybridizing:  78%|███████▊  | 1790/2304 [00:35<00:10, 49.57it/s]
Hybridizing:  78%|███████▊  | 1796/2304 [00:35<00:10, 50.08it/s]
Hybridizing:  78%|███████▊  | 1802/2304 [00:35<00:09, 50.46it/s]
Hybridizing:  78%|███████▊  | 1808/2304 [00:35<00:09, 50.69it/s]
Hybridizing:  79%|███████▊  | 1814/2304 [00:35<00:09, 50.88it/s]
Hybridizing:  79%|███████▉  | 1820/2304 [00:35<00:09, 50.98it/s]
Hybridizing:  79%|███████▉  | 1826/2304 [00:35<00:09, 51.13it/s]
Hybridizing:  80%|███████▉  | 1832/2304 [00:36<00:09, 51.15it/s]
Hybridizing:  80%|███████▉  | 1838/2304 [00:36<00:09, 51.19it/s]
Hybridizing:  80%|████████  | 1844/2304 [00:36<00:08, 51.21it/s]
Hybridizing:  80%|████████  | 1850/2304 [00:36<00:09, 49.64it/s]
Hybridizing:  81%|████████  | 1856/2304 [00:36<00:08, 50.12it/s]
Hybridizing:  81%|████████  | 1862/2304 [00:36<00:09, 48.84it/s]
Hybridizing:  81%|████████  | 1868/2304 [00:36<00:08, 49.45it/s]
Hybridizing:  81%|████████▏ | 1874/2304 [00:36<00:08, 50.03it/s]
Hybridizing:  82%|████████▏ | 1880/2304 [00:37<00:08, 50.35it/s]
Hybridizing:  82%|████████▏ | 1886/2304 [00:37<00:08, 50.65it/s]
Hybridizing:  82%|████████▏ | 1892/2304 [00:37<00:08, 50.76it/s]
Hybridizing:  82%|████████▏ | 1898/2304 [00:37<00:07, 50.96it/s]
Hybridizing:  83%|████████▎ | 1904/2304 [00:37<00:07, 51.03it/s]
Hybridizing:  83%|████████▎ | 1910/2304 [00:37<00:07, 51.08it/s]
Hybridizing:  83%|████████▎ | 1916/2304 [00:37<00:07, 51.10it/s]
Hybridizing:  83%|████████▎ | 1922/2304 [00:37<00:07, 51.21it/s]
Hybridizing:  84%|████████▎ | 1928/2304 [00:37<00:07, 49.82it/s]
Hybridizing:  84%|████████▍ | 1934/2304 [00:38<00:07, 49.95it/s]
Hybridizing:  84%|████████▍ | 1940/2304 [00:38<00:07, 50.33it/s]
Hybridizing:  84%|████████▍ | 1946/2304 [00:38<00:07, 50.67it/s]
Hybridizing:  85%|████████▍ | 1952/2304 [00:38<00:07, 49.11it/s]
Hybridizing:  85%|████████▍ | 1958/2304 [00:38<00:06, 49.71it/s]
Hybridizing:  85%|████████▌ | 1964/2304 [00:38<00:06, 50.13it/s]
Hybridizing:  86%|████████▌ | 1970/2304 [00:38<00:06, 50.52it/s]
Hybridizing:  86%|████████▌ | 1976/2304 [00:38<00:06, 50.69it/s]
Hybridizing:  86%|████████▌ | 1982/2304 [00:39<00:06, 50.86it/s]
Hybridizing:  86%|████████▋ | 1988/2304 [00:39<00:06, 50.90it/s]
Hybridizing:  87%|████████▋ | 1994/2304 [00:39<00:06, 51.04it/s]
Hybridizing:  87%|████████▋ | 2000/2304 [00:39<00:05, 51.04it/s]
Hybridizing:  87%|████████▋ | 2006/2304 [00:39<00:05, 51.14it/s]
Hybridizing:  87%|████████▋ | 2012/2304 [00:39<00:05, 51.09it/s]
Hybridizing:  88%|████████▊ | 2018/2304 [00:39<00:05, 51.18it/s]
Hybridizing:  88%|████████▊ | 2024/2304 [00:39<00:05, 51.15it/s]
Hybridizing:  88%|████████▊ | 2030/2304 [00:39<00:05, 49.69it/s]
Hybridizing:  88%|████████▊ | 2036/2304 [00:40<00:05, 50.11it/s]
Hybridizing:  89%|████████▊ | 2042/2304 [00:40<00:05, 48.86it/s]
Hybridizing:  89%|████████▉ | 2048/2304 [00:40<00:05, 49.56it/s]
Hybridizing:  89%|████████▉ | 2054/2304 [00:40<00:04, 50.07it/s]
Hybridizing:  89%|████████▉ | 2060/2304 [00:40<00:04, 50.40it/s]
Hybridizing:  90%|████████▉ | 2066/2304 [00:40<00:04, 50.74it/s]
Hybridizing:  90%|████████▉ | 2072/2304 [00:40<00:04, 50.89it/s]
Hybridizing:  90%|█████████ | 2078/2304 [00:40<00:04, 51.01it/s]
Hybridizing:  90%|█████████ | 2084/2304 [00:41<00:04, 51.03it/s]
Hybridizing:  91%|█████████ | 2090/2304 [00:41<00:04, 51.18it/s]
Hybridizing:  91%|█████████ | 2096/2304 [00:41<00:04, 51.17it/s]
Hybridizing:  91%|█████████ | 2102/2304 [00:41<00:03, 51.20it/s]
Hybridizing:  91%|█████████▏| 2108/2304 [00:41<00:03, 49.38it/s]
Hybridizing:  92%|█████████▏| 2114/2304 [00:41<00:03, 49.99it/s]
Hybridizing:  92%|█████████▏| 2120/2304 [00:41<00:03, 48.71it/s]
Hybridizing:  92%|█████████▏| 2126/2304 [00:41<00:03, 49.41it/s]
Hybridizing:  93%|█████████▎| 2132/2304 [00:42<00:03, 49.92it/s]
Hybridizing:  93%|█████████▎| 2138/2304 [00:42<00:03, 50.34it/s]
Hybridizing:  93%|█████████▎| 2144/2304 [00:42<00:03, 50.57it/s]
Hybridizing:  93%|█████████▎| 2150/2304 [00:42<00:03, 50.77it/s]
Hybridizing:  94%|█████████▎| 2156/2304 [00:42<00:02, 50.90it/s]
Hybridizing:  94%|█████████▍| 2162/2304 [00:42<00:02, 51.03it/s]
Hybridizing:  94%|█████████▍| 2168/2304 [00:42<00:02, 51.07it/s]
Hybridizing:  94%|█████████▍| 2174/2304 [00:42<00:02, 51.14it/s]
Hybridizing:  95%|█████████▍| 2180/2304 [00:42<00:02, 50.50it/s]
Hybridizing:  95%|█████████▍| 2186/2304 [00:43<00:02, 49.71it/s]
Hybridizing:  95%|█████████▌| 2192/2304 [00:43<00:02, 50.16it/s]
Hybridizing:  95%|█████████▌| 2198/2304 [00:43<00:02, 50.49it/s]
Hybridizing:  96%|█████████▌| 2204/2304 [00:43<00:01, 50.70it/s]
Hybridizing:  96%|█████████▌| 2210/2304 [00:43<00:01, 50.91it/s]
Hybridizing:  96%|█████████▌| 2216/2304 [00:43<00:01, 51.02it/s]
Hybridizing:  96%|█████████▋| 2222/2304 [00:43<00:01, 51.12it/s]
Hybridizing:  97%|█████████▋| 2228/2304 [00:43<00:01, 51.13it/s]
Hybridizing:  97%|█████████▋| 2234/2304 [00:44<00:01, 51.19it/s]
Hybridizing:  97%|█████████▋| 2240/2304 [00:44<00:01, 51.19it/s]
Hybridizing:  97%|█████████▋| 2246/2304 [00:44<00:01, 51.23it/s]
Hybridizing:  98%|█████████▊| 2252/2304 [00:44<00:01, 51.20it/s]
Hybridizing:  98%|█████████▊| 2258/2304 [00:44<00:00, 49.76it/s]
Hybridizing:  98%|█████████▊| 2264/2304 [00:44<00:00, 50.16it/s]
Hybridizing:  99%|█████████▊| 2270/2304 [00:44<00:00, 48.94it/s]
Hybridizing:  99%|█████████▉| 2276/2304 [00:44<00:00, 49.58it/s]
Hybridizing:  99%|█████████▉| 2282/2304 [00:44<00:00, 50.12it/s]
Hybridizing:  99%|█████████▉| 2288/2304 [00:45<00:00, 50.43it/s]
Hybridizing: 100%|█████████▉| 2294/2304 [00:45<00:00, 50.66it/s]
Hybridizing: 100%|█████████▉| 2300/2304 [00:45<00:00, 50.81it/s]
Hybridizing: 100%|██████████| 2304/2304 [00:45<00:00, 50.73it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_hybrid_last_last_rideshare_with_missing', 'base_model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/pretrain_run_20251020_205126/checkpoints/last.ckpt', 'base_model.patch_size=32', 'base_model.context_length=1000', 'precond_model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d2_20251117_203920/checkpoints/last.ckpt', 'precond_model.patch_size=32', 'precond_model.context_length=1000', 'precond_model.precondition_type=chebyshev', 'precond_model.precondition_degree=2', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=rideshare_with_missing', 'data.prediction_length=168']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_hybrid.py", line 406, in main
    res = evaluate_hybrid_model(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_hybrid.py", line 334, in evaluate_hybrid_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
