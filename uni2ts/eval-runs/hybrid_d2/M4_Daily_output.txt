[2025-11-19 12:06:19,877][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:06:19,878][datasets][INFO] - JAX version 0.6.1 available.
Hybrid Evaluation Configuration:
  Base model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading base model...
Loading preconditioned model...
Generating base model predictions...
Generating preconditioned model predictions...
Generated 4227 forecast pairs
Extracting input windows from test data...
Extracted 4227 input windows
Creating hybrid forecasts...
Created 4227 hybrid forecasts
Computing metrics...

================================================================================
HYBRID EVALUATION METRICS
================================================================================
      MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]    MSIS  mean_weighted_sum_quantile_loss
None 901029.869   404.815      0.069       0.071      8.026     949.226        0.148    0.063 196.281                            0.057
================================================================================

Metrics saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/2025-11-19/12-06-19/metrics_hybrid.csv


Base model:   0%|          | 0/4227 [00:00<?, ?it/s]
Base model:   0%|          | 1/4227 [00:00<18:13,  3.87it/s]
Base model:   5%|▍         | 193/4227 [00:00<00:06, 651.49it/s]
Base model:   9%|▉         | 385/4227 [00:00<00:03, 1012.09it/s]
Base model:  14%|█▎        | 577/4227 [00:00<00:02, 1240.52it/s]
Base model:  18%|█▊        | 769/4227 [00:00<00:02, 1392.21it/s]
Base model:  23%|██▎       | 961/4227 [00:00<00:02, 1489.94it/s]
Base model:  27%|██▋       | 1153/4227 [00:00<00:01, 1553.96it/s]
Base model:  32%|███▏      | 1345/4227 [00:01<00:01, 1597.82it/s]
Base model:  36%|███▋      | 1537/4227 [00:01<00:01, 1626.19it/s]
Base model:  41%|████      | 1729/4227 [00:01<00:01, 1646.86it/s]
Base model:  45%|████▌     | 1921/4227 [00:01<00:01, 1661.10it/s]
Base model:  49%|████▉     | 2089/4227 [00:01<00:01, 1644.35it/s]
Base model:  54%|█████▍    | 2273/4227 [00:01<00:01, 1639.53it/s]
Base model:  58%|█████▊    | 2438/4227 [00:01<00:01, 1621.88it/s]
Base model:  62%|██████▏   | 2625/4227 [00:01<00:00, 1633.46it/s]
Base model:  67%|██████▋   | 2817/4227 [00:01<00:00, 1654.19it/s]
Base model:  71%|███████   | 3009/4227 [00:02<00:00, 1670.48it/s]
Base model:  76%|███████▌  | 3201/4227 [00:02<00:00, 1680.96it/s]
Base model:  80%|████████  | 3393/4227 [00:02<00:00, 1687.07it/s]
Base model:  85%|████████▍ | 3585/4227 [00:02<00:00, 1692.31it/s]
Base model:  89%|████████▉ | 3777/4227 [00:02<00:00, 1694.13it/s]
Base model:  94%|█████████▍| 3969/4227 [00:02<00:00, 1694.51it/s]
Base model:  98%|█████████▊| 4161/4227 [00:02<00:00, 1691.51it/s]
Base model: 100%|██████████| 4227/4227 [00:02<00:00, 1516.83it/s]

Precond model:   0%|          | 0/4227 [00:00<?, ?it/s]
Precond model:   3%|▎         | 129/4227 [00:00<00:03, 1286.24it/s]
Precond model:   8%|▊         | 321/4227 [00:00<00:02, 1488.86it/s]
Precond model:  11%|█▏        | 481/4227 [00:00<00:02, 1477.88it/s]
Precond model:  16%|█▌        | 673/4227 [00:00<00:02, 1537.16it/s]
Precond model:  20%|█▉        | 833/4227 [00:00<00:02, 1500.78it/s]
Precond model:  23%|██▎       | 993/4227 [00:00<00:02, 1531.43it/s]
Precond model:  28%|██▊       | 1185/4227 [00:00<00:01, 1556.74it/s]
Precond model:  33%|███▎      | 1375/4227 [00:00<00:01, 1657.63it/s]
Precond model:  36%|███▋      | 1542/4227 [00:00<00:01, 1571.45it/s]
Precond model:  41%|████      | 1729/4227 [00:01<00:01, 1570.55it/s]
Precond model:  45%|████▌     | 1921/4227 [00:01<00:01, 1585.06it/s]
Precond model:  50%|████▉     | 2113/4227 [00:01<00:01, 1592.69it/s]
Precond model:  54%|█████▍    | 2281/4227 [00:01<00:01, 1616.37it/s]
Precond model:  58%|█████▊    | 2444/4227 [00:01<00:01, 1618.73it/s]
Precond model:  62%|██████▏   | 2607/4227 [00:01<00:01, 1618.90it/s]
Precond model:  66%|██████▌   | 2770/4227 [00:01<00:00, 1621.00it/s]
Precond model:  70%|██████▉   | 2941/4227 [00:01<00:00, 1646.94it/s]
Precond model:  73%|███████▎  | 3106/4227 [00:01<00:00, 1546.18it/s]
Precond model:  77%|███████▋  | 3265/4227 [00:02<00:00, 1535.17it/s]
Precond model:  81%|████████  | 3425/4227 [00:02<00:00, 1515.31it/s]
Precond model:  85%|████████▍ | 3585/4227 [00:02<00:00, 1533.50it/s]
Precond model:  89%|████████▉ | 3777/4227 [00:02<00:00, 1558.67it/s]
Precond model:  93%|█████████▎| 3937/4227 [00:02<00:00, 1550.54it/s]
Precond model:  98%|█████████▊| 4129/4227 [00:02<00:00, 1569.74it/s]
Precond model: 100%|██████████| 4227/4227 [00:02<00:00, 1570.60it/s]

Hybridizing:   0%|          | 0/4227 [00:00<?, ?it/s]
Hybridizing:   1%|▏         | 57/4227 [00:00<00:07, 561.55it/s]
Hybridizing:   3%|▎         | 114/4227 [00:00<00:07, 561.65it/s]
Hybridizing:   4%|▍         | 171/4227 [00:00<00:07, 559.47it/s]
Hybridizing:   5%|▌         | 227/4227 [00:00<00:07, 558.33it/s]
Hybridizing:   7%|▋         | 285/4227 [00:00<00:06, 563.19it/s]
Hybridizing:   8%|▊         | 342/4227 [00:00<00:06, 559.87it/s]
Hybridizing:   9%|▉         | 398/4227 [00:00<00:06, 557.55it/s]
Hybridizing:  11%|█         | 455/4227 [00:00<00:06, 559.09it/s]
Hybridizing:  12%|█▏        | 511/4227 [00:00<00:06, 555.28it/s]
Hybridizing:  13%|█▎        | 567/4227 [00:01<00:06, 531.97it/s]
Hybridizing:  15%|█▍        | 623/4227 [00:01<00:06, 537.43it/s]
Hybridizing:  16%|█▌        | 678/4227 [00:01<00:06, 539.90it/s]
Hybridizing:  17%|█▋        | 733/4227 [00:01<00:06, 542.64it/s]
Hybridizing:  19%|█▊        | 788/4227 [00:01<00:06, 523.81it/s]
Hybridizing:  20%|█▉        | 843/4227 [00:01<00:06, 531.15it/s]
Hybridizing:  21%|██        | 898/4227 [00:01<00:06, 535.52it/s]
Hybridizing:  23%|██▎       | 954/4227 [00:01<00:06, 539.91it/s]
Hybridizing:  24%|██▍       | 1010/4227 [00:01<00:05, 543.10it/s]
Hybridizing:  25%|██▌       | 1065/4227 [00:01<00:05, 544.29it/s]
Hybridizing:  26%|██▋       | 1120/4227 [00:02<00:05, 543.94it/s]
Hybridizing:  28%|██▊       | 1175/4227 [00:02<00:05, 544.62it/s]
Hybridizing:  29%|██▉       | 1230/4227 [00:02<00:05, 546.21it/s]
Hybridizing:  30%|███       | 1285/4227 [00:02<00:05, 546.47it/s]
Hybridizing:  32%|███▏      | 1340/4227 [00:02<00:05, 547.44it/s]
Hybridizing:  33%|███▎      | 1395/4227 [00:02<00:05, 547.04it/s]
Hybridizing:  34%|███▍      | 1450/4227 [00:02<00:05, 547.79it/s]
Hybridizing:  36%|███▌      | 1505/4227 [00:02<00:05, 527.23it/s]
Hybridizing:  37%|███▋      | 1560/4227 [00:02<00:04, 533.67it/s]
Hybridizing:  38%|███▊      | 1615/4227 [00:02<00:04, 537.46it/s]
Hybridizing:  39%|███▉      | 1669/4227 [00:03<00:04, 523.33it/s]
Hybridizing:  41%|████      | 1725/4227 [00:03<00:04, 532.65it/s]
Hybridizing:  42%|████▏     | 1782/4227 [00:03<00:04, 541.22it/s]
Hybridizing:  44%|████▎     | 1839/4227 [00:03<00:04, 547.33it/s]
Hybridizing:  45%|████▍     | 1896/4227 [00:03<00:04, 552.38it/s]
Hybridizing:  46%|████▌     | 1953/4227 [00:03<00:04, 554.86it/s]
Hybridizing:  48%|████▊     | 2009/4227 [00:03<00:04, 551.35it/s]
Hybridizing:  49%|████▉     | 2065/4227 [00:03<00:03, 552.56it/s]
Hybridizing:  50%|█████     | 2122/4227 [00:03<00:03, 555.22it/s]
Hybridizing:  52%|█████▏    | 2179/4227 [00:03<00:03, 558.60it/s]
Hybridizing:  53%|█████▎    | 2236/4227 [00:04<00:03, 560.88it/s]
Hybridizing:  54%|█████▍    | 2293/4227 [00:04<00:03, 557.21it/s]
Hybridizing:  56%|█████▌    | 2349/4227 [00:04<00:03, 553.85it/s]
Hybridizing:  57%|█████▋    | 2405/4227 [00:04<00:03, 532.60it/s]
Hybridizing:  58%|█████▊    | 2460/4227 [00:04<00:03, 535.83it/s]
Hybridizing:  59%|█████▉    | 2515/4227 [00:04<00:03, 537.99it/s]
Hybridizing:  61%|██████    | 2569/4227 [00:04<00:03, 519.96it/s]
Hybridizing:  62%|██████▏   | 2624/4227 [00:04<00:03, 527.59it/s]
Hybridizing:  63%|██████▎   | 2679/4227 [00:04<00:02, 534.05it/s]
Hybridizing:  65%|██████▍   | 2734/4227 [00:05<00:02, 537.49it/s]
Hybridizing:  66%|██████▌   | 2789/4227 [00:05<00:02, 541.12it/s]
Hybridizing:  67%|██████▋   | 2844/4227 [00:05<00:02, 542.66it/s]
Hybridizing:  69%|██████▊   | 2899/4227 [00:05<00:02, 544.83it/s]
Hybridizing:  70%|██████▉   | 2954/4227 [00:05<00:02, 545.30it/s]
Hybridizing:  71%|███████   | 3009/4227 [00:05<00:02, 546.65it/s]
Hybridizing:  72%|███████▏  | 3064/4227 [00:05<00:02, 546.48it/s]
Hybridizing:  74%|███████▍  | 3119/4227 [00:05<00:02, 547.39it/s]
Hybridizing:  75%|███████▌  | 3174/4227 [00:05<00:01, 547.22it/s]
Hybridizing:  76%|███████▋  | 3229/4227 [00:05<00:01, 547.81it/s]
Hybridizing:  78%|███████▊  | 3284/4227 [00:06<00:01, 528.62it/s]
Hybridizing:  79%|███████▉  | 3340/4227 [00:06<00:01, 535.06it/s]
Hybridizing:  80%|████████  | 3394/4227 [00:06<00:01, 520.08it/s]
Hybridizing:  82%|████████▏ | 3449/4227 [00:06<00:01, 528.67it/s]
Hybridizing:  83%|████████▎ | 3504/4227 [00:06<00:01, 533.91it/s]
Hybridizing:  84%|████████▍ | 3559/4227 [00:06<00:01, 537.69it/s]
Hybridizing:  86%|████████▌ | 3615/4227 [00:06<00:01, 541.40it/s]
Hybridizing:  87%|████████▋ | 3672/4227 [00:06<00:01, 547.86it/s]
Hybridizing:  88%|████████▊ | 3729/4227 [00:06<00:00, 553.05it/s]
Hybridizing:  90%|████████▉ | 3786/4227 [00:06<00:00, 556.05it/s]
Hybridizing:  91%|█████████ | 3844/4227 [00:07<00:00, 562.93it/s]
Hybridizing:  92%|█████████▏| 3902/4227 [00:07<00:00, 567.23it/s]
Hybridizing:  94%|█████████▎| 3960/4227 [00:07<00:00, 568.98it/s]
Hybridizing:  95%|█████████▌| 4017/4227 [00:07<00:00, 568.52it/s]
Hybridizing:  96%|█████████▋| 4075/4227 [00:07<00:00, 570.78it/s]
Hybridizing:  98%|█████████▊| 4133/4227 [00:07<00:00, 547.43it/s]
Hybridizing:  99%|█████████▉| 4189/4227 [00:07<00:00, 550.81it/s]
Hybridizing: 100%|██████████| 4227/4227 [00:07<00:00, 545.34it/s]

0it [00:00, ?it/s]
160it [00:00, 1356.26it/s]
352it [00:00, 1548.98it/s]
512it [00:00, 1399.06it/s]
672it [00:00, 1303.45it/s]
832it [00:00, 1112.32it/s]
960it [00:00, 1041.28it/s]
1088it [00:00, 1041.34it/s]
1216it [00:01, 992.37it/s] 
1344it [00:01, 955.98it/s]
1472it [00:01, 971.69it/s]
1600it [00:01, 956.17it/s]
1760it [00:01, 1111.23it/s]
1920it [00:01, 1233.53it/s]
2080it [00:01, 1319.29it/s]
2272it [00:01, 1357.11it/s]
2432it [00:02, 1153.86it/s]
2560it [00:02, 1102.14it/s]
2688it [00:02, 1068.28it/s]
2816it [00:02, 1022.57it/s]
2944it [00:02, 994.17it/s] 
3072it [00:02, 985.70it/s]
3200it [00:02, 966.87it/s]
3328it [00:03, 942.58it/s]
3424it [00:03, 937.50it/s]
3520it [00:03, 931.42it/s]
3648it [00:03, 1000.58it/s]
3840it [00:03, 1225.58it/s]
4000it [00:03, 1327.17it/s]
4192it [00:03, 1469.40it/s]
4227it [00:03, 1129.75it/s]
