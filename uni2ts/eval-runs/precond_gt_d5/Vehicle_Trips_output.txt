[2025-11-19 12:14:21,467][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:14:21,467][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 329 ground truth sequences
Generating preconditioned model predictions...
Generated 329 forecasts
Creating GT-context-reversed forecasts...
Created 329 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/329 [00:00<?, ?it/s]
Precond model:   0%|          | 1/329 [00:00<01:24,  3.86it/s]
Precond model:  49%|████▉     | 161/329 [00:00<00:00, 569.44it/s]
Precond model:  98%|█████████▊| 321/329 [00:00<00:00, 909.94it/s]
Precond model: 100%|██████████| 329/329 [00:00<00:00, 711.98it/s]

GT reversal:   0%|          | 0/329 [00:00<?, ?it/s]
GT reversal:   4%|▍         | 13/329 [00:00<00:02, 128.32it/s]
GT reversal:   8%|▊         | 26/329 [00:00<00:02, 128.46it/s]
GT reversal:  12%|█▏        | 39/329 [00:00<00:02, 128.45it/s]
GT reversal:  16%|█▌        | 52/329 [00:00<00:02, 128.46it/s]
GT reversal:  20%|█▉        | 65/329 [00:00<00:02, 128.43it/s]
GT reversal:  24%|██▎       | 78/329 [00:00<00:01, 128.52it/s]
GT reversal:  28%|██▊       | 91/329 [00:00<00:01, 128.62it/s]
GT reversal:  32%|███▏      | 104/329 [00:00<00:01, 128.60it/s]
GT reversal:  36%|███▌      | 117/329 [00:00<00:01, 127.81it/s]
GT reversal:  40%|███▉      | 130/329 [00:01<00:01, 128.14it/s]
GT reversal:  43%|████▎     | 143/329 [00:01<00:01, 128.41it/s]
GT reversal:  47%|████▋     | 156/329 [00:01<00:01, 128.59it/s]
GT reversal:  51%|█████▏    | 169/329 [00:01<00:01, 128.73it/s]
GT reversal:  55%|█████▌    | 182/329 [00:01<00:01, 128.80it/s]
GT reversal:  59%|█████▉    | 195/329 [00:01<00:01, 128.82it/s]
GT reversal:  63%|██████▎   | 208/329 [00:01<00:00, 128.85it/s]
GT reversal:  67%|██████▋   | 221/329 [00:01<00:00, 128.92it/s]
GT reversal:  71%|███████   | 234/329 [00:01<00:00, 128.98it/s]
GT reversal:  75%|███████▌  | 247/329 [00:01<00:00, 128.94it/s]
GT reversal:  79%|███████▉  | 260/329 [00:02<00:00, 128.98it/s]
GT reversal:  83%|████████▎ | 273/329 [00:02<00:00, 128.86it/s]
GT reversal:  87%|████████▋ | 286/329 [00:02<00:00, 128.74it/s]
GT reversal:  91%|█████████ | 299/329 [00:02<00:00, 127.64it/s]
GT reversal:  95%|█████████▍| 312/329 [00:02<00:00, 127.78it/s]
GT reversal:  99%|█████████▉| 325/329 [00:02<00:00, 127.96it/s]
GT reversal: 100%|██████████| 329/329 [00:02<00:00, 128.47it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_vehicle_trips_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d5_20251117_204835/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=5', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=vehicle_trips_with_missing', 'data.prediction_length=30']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
