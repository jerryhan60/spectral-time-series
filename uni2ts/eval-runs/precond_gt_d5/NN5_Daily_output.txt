[2025-11-19 12:15:47,620][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:15:47,623][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 111 ground truth sequences
Generating preconditioned model predictions...
Generated 111 forecasts
Creating GT-context-reversed forecasts...
Created 111 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/111 [00:00<?, ?it/s]
Precond model:   1%|          | 1/111 [00:00<00:28,  3.85it/s]
Precond model: 100%|██████████| 111/111 [00:00<00:00, 346.31it/s]

GT reversal:   0%|          | 0/111 [00:00<?, ?it/s]
GT reversal:   6%|▋         | 7/111 [00:00<00:01, 65.28it/s]
GT reversal:  13%|█▎        | 14/111 [00:00<00:01, 64.44it/s]
GT reversal:  19%|█▉        | 21/111 [00:00<00:01, 64.15it/s]
GT reversal:  25%|██▌       | 28/111 [00:00<00:01, 64.03it/s]
GT reversal:  32%|███▏      | 35/111 [00:00<00:01, 63.96it/s]
GT reversal:  38%|███▊      | 42/111 [00:00<00:01, 63.94it/s]
GT reversal:  44%|████▍     | 49/111 [00:00<00:00, 63.41it/s]
GT reversal:  50%|█████     | 56/111 [00:00<00:00, 63.55it/s]
GT reversal:  57%|█████▋    | 63/111 [00:00<00:00, 63.68it/s]
GT reversal:  63%|██████▎   | 70/111 [00:01<00:00, 63.68it/s]
GT reversal:  69%|██████▉   | 77/111 [00:01<00:00, 63.73it/s]
GT reversal:  76%|███████▌  | 84/111 [00:01<00:00, 63.77it/s]
GT reversal:  82%|████████▏ | 91/111 [00:01<00:00, 63.75it/s]
GT reversal:  88%|████████▊ | 98/111 [00:01<00:00, 63.77it/s]
GT reversal:  95%|█████████▍| 105/111 [00:01<00:00, 63.80it/s]
GT reversal: 100%|██████████| 111/111 [00:01<00:00, 63.83it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_nn5_daily_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d5_20251117_204835/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=5', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=nn5_daily_with_missing', 'data.prediction_length=56']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
