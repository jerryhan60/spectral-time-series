[2025-11-19 12:12:50,279][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:12:50,281][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 4227 ground truth sequences
Generating preconditioned model predictions...
Generated 4227 forecasts
Creating GT-context-reversed forecasts...
Created 4227 GT-context-reversed forecasts
Computing metrics...

================================================================================
GROUND TRUTH CONTEXT EVALUATION METRICS
================================================================================
      MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]   MSIS  mean_weighted_sum_quantile_loss
None 281567.423    88.871      0.015       0.015      1.666     530.629        0.083    0.014 14.135                            0.011
================================================================================

Metrics saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/2025-11-19/12-12-50/metrics_gt_context.csv


Precond model:   0%|          | 0/4227 [00:00<?, ?it/s]
Precond model:   0%|          | 1/4227 [00:00<18:08,  3.88it/s]
Precond model:   4%|▍         | 161/4227 [00:00<00:07, 567.36it/s]
Precond model:   8%|▊         | 321/4227 [00:00<00:04, 913.34it/s]
Precond model:  11%|█▏        | 481/4227 [00:00<00:03, 1132.15it/s]
Precond model:  15%|█▌        | 641/4227 [00:00<00:02, 1269.78it/s]
Precond model:  19%|█▉        | 801/4227 [00:00<00:02, 1363.36it/s]
Precond model:  23%|██▎       | 961/4227 [00:00<00:02, 1429.62it/s]
Precond model:  27%|██▋       | 1121/4227 [00:00<00:02, 1477.12it/s]
Precond model:  30%|███       | 1281/4227 [00:01<00:01, 1505.85it/s]
Precond model:  34%|███▍      | 1441/4227 [00:01<00:01, 1530.35it/s]
Precond model:  38%|███▊      | 1601/4227 [00:01<00:01, 1542.95it/s]
Precond model:  42%|████▏     | 1761/4227 [00:01<00:01, 1556.87it/s]
Precond model:  45%|████▌     | 1921/4227 [00:01<00:01, 1566.46it/s]
Precond model:  49%|████▉     | 2081/4227 [00:01<00:01, 1572.88it/s]
Precond model:  53%|█████▎    | 2241/4227 [00:01<00:01, 1575.29it/s]
Precond model:  57%|█████▋    | 2401/4227 [00:01<00:01, 1575.60it/s]
Precond model:  61%|██████    | 2561/4227 [00:01<00:01, 1579.71it/s]
Precond model:  64%|██████▍   | 2721/4227 [00:01<00:00, 1578.18it/s]
Precond model:  68%|██████▊   | 2881/4227 [00:02<00:00, 1571.95it/s]
Precond model:  72%|███████▏  | 3041/4227 [00:02<00:00, 1574.59it/s]
Precond model:  76%|███████▌  | 3201/4227 [00:02<00:00, 1575.05it/s]
Precond model:  80%|███████▉  | 3361/4227 [00:02<00:00, 1573.84it/s]
Precond model:  83%|████████▎ | 3521/4227 [00:02<00:00, 1574.64it/s]
Precond model:  87%|████████▋ | 3681/4227 [00:02<00:00, 1578.66it/s]
Precond model:  91%|█████████ | 3841/4227 [00:02<00:00, 1581.96it/s]
Precond model:  95%|█████████▍| 4001/4227 [00:02<00:00, 1584.33it/s]
Precond model:  98%|█████████▊| 4161/4227 [00:02<00:00, 1585.22it/s]
Precond model: 100%|██████████| 4227/4227 [00:02<00:00, 1441.05it/s]

GT reversal:   0%|          | 0/4227 [00:00<?, ?it/s]
GT reversal:   1%|          | 25/4227 [00:00<00:17, 243.31it/s]
GT reversal:   1%|          | 51/4227 [00:00<00:16, 248.02it/s]
GT reversal:   2%|▏         | 77/4227 [00:00<00:16, 253.11it/s]
GT reversal:   2%|▏         | 103/4227 [00:00<00:16, 249.81it/s]
GT reversal:   3%|▎         | 128/4227 [00:00<00:16, 245.72it/s]
GT reversal:   4%|▎         | 153/4227 [00:00<00:16, 245.77it/s]
GT reversal:   4%|▍         | 178/4227 [00:00<00:16, 244.70it/s]
GT reversal:   5%|▍         | 203/4227 [00:00<00:16, 243.20it/s]
GT reversal:   5%|▌         | 228/4227 [00:00<00:16, 244.19it/s]
GT reversal:   6%|▌         | 254/4227 [00:01<00:16, 246.46it/s]
GT reversal:   7%|▋         | 280/4227 [00:01<00:15, 250.39it/s]
GT reversal:   7%|▋         | 306/4227 [00:01<00:15, 251.15it/s]
GT reversal:   8%|▊         | 332/4227 [00:01<00:15, 249.94it/s]
GT reversal:   8%|▊         | 358/4227 [00:01<00:15, 251.08it/s]
GT reversal:   9%|▉         | 384/4227 [00:01<00:15, 249.91it/s]
GT reversal:  10%|▉         | 410/4227 [00:01<00:15, 251.07it/s]
GT reversal:  10%|█         | 436/4227 [00:01<00:14, 253.45it/s]
GT reversal:  11%|█         | 462/4227 [00:01<00:14, 253.47it/s]
GT reversal:  12%|█▏        | 488/4227 [00:01<00:14, 251.37it/s]
GT reversal:  12%|█▏        | 514/4227 [00:02<00:14, 249.99it/s]
GT reversal:  13%|█▎        | 540/4227 [00:02<00:14, 249.00it/s]
GT reversal:  13%|█▎        | 565/4227 [00:02<00:14, 248.13it/s]
GT reversal:  14%|█▍        | 590/4227 [00:02<00:14, 248.49it/s]
GT reversal:  15%|█▍        | 615/4227 [00:02<00:14, 248.68it/s]
GT reversal:  15%|█▌        | 640/4227 [00:02<00:14, 247.91it/s]
GT reversal:  16%|█▌        | 665/4227 [00:02<00:14, 247.44it/s]
GT reversal:  16%|█▋        | 690/4227 [00:02<00:14, 247.24it/s]
GT reversal:  17%|█▋        | 715/4227 [00:02<00:14, 247.12it/s]
GT reversal:  18%|█▊        | 740/4227 [00:02<00:14, 245.12it/s]
GT reversal:  18%|█▊        | 765/4227 [00:03<00:14, 245.35it/s]
GT reversal:  19%|█▊        | 790/4227 [00:03<00:13, 246.44it/s]
GT reversal:  19%|█▉        | 815/4227 [00:03<00:13, 247.36it/s]
GT reversal:  20%|█▉        | 840/4227 [00:03<00:13, 246.99it/s]
GT reversal:  20%|██        | 865/4227 [00:03<00:13, 246.90it/s]
GT reversal:  21%|██        | 890/4227 [00:03<00:13, 246.85it/s]
GT reversal:  22%|██▏       | 915/4227 [00:03<00:13, 246.91it/s]
GT reversal:  22%|██▏       | 940/4227 [00:03<00:13, 246.87it/s]
GT reversal:  23%|██▎       | 965/4227 [00:03<00:13, 246.62it/s]
GT reversal:  23%|██▎       | 990/4227 [00:03<00:13, 247.34it/s]
GT reversal:  24%|██▍       | 1015/4227 [00:04<00:12, 247.76it/s]
GT reversal:  25%|██▍       | 1040/4227 [00:04<00:12, 247.31it/s]
GT reversal:  25%|██▌       | 1065/4227 [00:04<00:12, 247.03it/s]
GT reversal:  26%|██▌       | 1090/4227 [00:04<00:12, 246.94it/s]
GT reversal:  26%|██▋       | 1115/4227 [00:04<00:12, 246.75it/s]
GT reversal:  27%|██▋       | 1140/4227 [00:04<00:12, 246.67it/s]
GT reversal:  28%|██▊       | 1165/4227 [00:04<00:12, 246.40it/s]
GT reversal:  28%|██▊       | 1190/4227 [00:04<00:12, 247.10it/s]
GT reversal:  29%|██▊       | 1215/4227 [00:04<00:12, 247.66it/s]
GT reversal:  29%|██▉       | 1240/4227 [00:05<00:12, 247.30it/s]
GT reversal:  30%|██▉       | 1265/4227 [00:05<00:11, 247.12it/s]
GT reversal:  31%|███       | 1290/4227 [00:05<00:11, 247.06it/s]
GT reversal:  31%|███       | 1315/4227 [00:05<00:11, 246.99it/s]
GT reversal:  32%|███▏      | 1340/4227 [00:05<00:11, 246.13it/s]
GT reversal:  32%|███▏      | 1365/4227 [00:05<00:11, 246.07it/s]
GT reversal:  33%|███▎      | 1390/4227 [00:05<00:11, 246.97it/s]
GT reversal:  33%|███▎      | 1415/4227 [00:05<00:11, 247.52it/s]
GT reversal:  34%|███▍      | 1440/4227 [00:05<00:11, 247.25it/s]
GT reversal:  35%|███▍      | 1465/4227 [00:05<00:11, 247.16it/s]
GT reversal:  35%|███▌      | 1490/4227 [00:06<00:11, 246.83it/s]
GT reversal:  36%|███▌      | 1515/4227 [00:06<00:10, 246.72it/s]
GT reversal:  36%|███▋      | 1540/4227 [00:06<00:10, 246.89it/s]
GT reversal:  37%|███▋      | 1565/4227 [00:06<00:10, 246.54it/s]
GT reversal:  38%|███▊      | 1590/4227 [00:06<00:10, 245.50it/s]
GT reversal:  38%|███▊      | 1615/4227 [00:06<00:10, 246.54it/s]
GT reversal:  39%|███▉      | 1641/4227 [00:06<00:10, 248.25it/s]
GT reversal:  39%|███▉      | 1667/4227 [00:06<00:10, 250.04it/s]
GT reversal:  40%|████      | 1693/4227 [00:06<00:10, 251.48it/s]
GT reversal:  41%|████      | 1719/4227 [00:06<00:09, 251.38it/s]
GT reversal:  41%|████▏     | 1745/4227 [00:07<00:09, 251.97it/s]
GT reversal:  42%|████▏     | 1771/4227 [00:07<00:09, 252.36it/s]
GT reversal:  43%|████▎     | 1797/4227 [00:07<00:09, 252.11it/s]
GT reversal:  43%|████▎     | 1823/4227 [00:07<00:09, 251.87it/s]
GT reversal:  44%|████▎     | 1849/4227 [00:07<00:09, 252.86it/s]
GT reversal:  44%|████▍     | 1875/4227 [00:07<00:09, 253.85it/s]
GT reversal:  45%|████▍     | 1901/4227 [00:07<00:09, 254.79it/s]
GT reversal:  46%|████▌     | 1927/4227 [00:07<00:09, 255.12it/s]
GT reversal:  46%|████▌     | 1953/4227 [00:07<00:08, 254.89it/s]
GT reversal:  47%|████▋     | 1979/4227 [00:07<00:08, 253.21it/s]
GT reversal:  47%|████▋     | 2005/4227 [00:08<00:08, 253.18it/s]
GT reversal:  48%|████▊     | 2031/4227 [00:08<00:08, 252.40it/s]
GT reversal:  49%|████▊     | 2057/4227 [00:08<00:08, 252.60it/s]
GT reversal:  49%|████▉     | 2083/4227 [00:08<00:08, 253.35it/s]
GT reversal:  50%|████▉     | 2109/4227 [00:08<00:08, 254.10it/s]
GT reversal:  51%|█████     | 2135/4227 [00:08<00:08, 254.27it/s]
GT reversal:  51%|█████     | 2162/4227 [00:08<00:08, 257.39it/s]
GT reversal:  52%|█████▏    | 2189/4227 [00:08<00:07, 260.36it/s]
GT reversal:  52%|█████▏    | 2216/4227 [00:08<00:07, 260.52it/s]
GT reversal:  53%|█████▎    | 2243/4227 [00:08<00:07, 256.56it/s]
GT reversal:  54%|█████▎    | 2269/4227 [00:09<00:07, 253.48it/s]
GT reversal:  54%|█████▍    | 2295/4227 [00:09<00:07, 251.42it/s]
GT reversal:  55%|█████▍    | 2321/4227 [00:09<00:07, 249.95it/s]
GT reversal:  56%|█████▌    | 2347/4227 [00:09<00:07, 248.75it/s]
GT reversal:  56%|█████▌    | 2372/4227 [00:09<00:07, 247.98it/s]
GT reversal:  57%|█████▋    | 2397/4227 [00:09<00:07, 247.49it/s]
GT reversal:  57%|█████▋    | 2422/4227 [00:09<00:07, 247.10it/s]
GT reversal:  58%|█████▊    | 2447/4227 [00:09<00:07, 246.89it/s]
GT reversal:  58%|█████▊    | 2472/4227 [00:09<00:07, 244.63it/s]
GT reversal:  59%|█████▉    | 2497/4227 [00:10<00:07, 245.74it/s]
GT reversal:  60%|█████▉    | 2522/4227 [00:10<00:06, 246.54it/s]
GT reversal:  60%|██████    | 2547/4227 [00:10<00:06, 246.30it/s]
GT reversal:  61%|██████    | 2572/4227 [00:10<00:06, 246.23it/s]
GT reversal:  61%|██████▏   | 2597/4227 [00:10<00:06, 246.23it/s]
GT reversal:  62%|██████▏   | 2622/4227 [00:10<00:06, 246.23it/s]
GT reversal:  63%|██████▎   | 2647/4227 [00:10<00:06, 246.11it/s]
GT reversal:  63%|██████▎   | 2672/4227 [00:10<00:06, 245.86it/s]
GT reversal:  64%|██████▍   | 2697/4227 [00:10<00:06, 246.56it/s]
GT reversal:  64%|██████▍   | 2722/4227 [00:10<00:06, 247.00it/s]
GT reversal:  65%|██████▍   | 2747/4227 [00:11<00:06, 246.60it/s]
GT reversal:  66%|██████▌   | 2772/4227 [00:11<00:05, 246.39it/s]
GT reversal:  66%|██████▌   | 2797/4227 [00:11<00:05, 246.36it/s]
GT reversal:  67%|██████▋   | 2822/4227 [00:11<00:05, 246.41it/s]
GT reversal:  67%|██████▋   | 2847/4227 [00:11<00:05, 246.27it/s]
GT reversal:  68%|██████▊   | 2872/4227 [00:11<00:05, 245.99it/s]
GT reversal:  69%|██████▊   | 2897/4227 [00:11<00:05, 246.71it/s]
GT reversal:  69%|██████▉   | 2922/4227 [00:11<00:05, 247.29it/s]
GT reversal:  70%|██████▉   | 2947/4227 [00:11<00:05, 246.98it/s]
GT reversal:  70%|███████   | 2972/4227 [00:11<00:05, 246.70it/s]
GT reversal:  71%|███████   | 2997/4227 [00:12<00:04, 246.46it/s]
GT reversal:  71%|███████▏  | 3022/4227 [00:12<00:04, 246.36it/s]
GT reversal:  72%|███████▏  | 3047/4227 [00:12<00:04, 246.17it/s]
GT reversal:  73%|███████▎  | 3072/4227 [00:12<00:04, 246.03it/s]
GT reversal:  73%|███████▎  | 3097/4227 [00:12<00:04, 246.82it/s]
GT reversal:  74%|███████▍  | 3122/4227 [00:12<00:04, 247.35it/s]
GT reversal:  74%|███████▍  | 3147/4227 [00:12<00:04, 247.04it/s]
GT reversal:  75%|███████▌  | 3172/4227 [00:12<00:04, 246.79it/s]
GT reversal:  76%|███████▌  | 3197/4227 [00:12<00:04, 246.58it/s]
GT reversal:  76%|███████▌  | 3222/4227 [00:12<00:04, 246.48it/s]
GT reversal:  77%|███████▋  | 3247/4227 [00:13<00:03, 246.41it/s]
GT reversal:  77%|███████▋  | 3272/4227 [00:13<00:03, 246.24it/s]
GT reversal:  78%|███████▊  | 3297/4227 [00:13<00:03, 247.05it/s]
GT reversal:  79%|███████▊  | 3322/4227 [00:13<00:03, 246.72it/s]
GT reversal:  79%|███████▉  | 3347/4227 [00:13<00:03, 246.42it/s]
GT reversal:  80%|███████▉  | 3372/4227 [00:13<00:03, 246.35it/s]
GT reversal:  80%|████████  | 3397/4227 [00:13<00:03, 246.36it/s]
GT reversal:  81%|████████  | 3422/4227 [00:13<00:03, 246.30it/s]
GT reversal:  82%|████████▏ | 3447/4227 [00:13<00:03, 246.29it/s]
GT reversal:  82%|████████▏ | 3472/4227 [00:13<00:03, 246.22it/s]
GT reversal:  83%|████████▎ | 3497/4227 [00:14<00:02, 247.01it/s]
GT reversal:  83%|████████▎ | 3522/4227 [00:14<00:02, 247.45it/s]
GT reversal:  84%|████████▍ | 3547/4227 [00:14<00:02, 246.75it/s]
GT reversal:  85%|████████▍ | 3572/4227 [00:14<00:02, 246.50it/s]
GT reversal:  85%|████████▌ | 3597/4227 [00:14<00:02, 246.41it/s]
GT reversal:  86%|████████▌ | 3622/4227 [00:14<00:02, 247.20it/s]
GT reversal:  86%|████████▋ | 3648/4227 [00:14<00:02, 250.56it/s]
GT reversal:  87%|████████▋ | 3674/4227 [00:14<00:02, 252.09it/s]
GT reversal:  88%|████████▊ | 3700/4227 [00:14<00:02, 253.50it/s]
GT reversal:  88%|████████▊ | 3727/4227 [00:14<00:01, 255.99it/s]
GT reversal:  89%|████████▉ | 3753/4227 [00:15<00:01, 256.15it/s]
GT reversal:  89%|████████▉ | 3779/4227 [00:15<00:01, 256.73it/s]
GT reversal:  90%|█████████ | 3806/4227 [00:15<00:01, 258.74it/s]
GT reversal:  91%|█████████ | 3833/4227 [00:15<00:01, 259.42it/s]
GT reversal:  91%|█████████▏| 3859/4227 [00:15<00:01, 259.03it/s]
GT reversal:  92%|█████████▏| 3885/4227 [00:15<00:01, 258.28it/s]
GT reversal:  93%|█████████▎| 3911/4227 [00:15<00:01, 257.78it/s]
GT reversal:  93%|█████████▎| 3937/4227 [00:15<00:01, 258.33it/s]
GT reversal:  94%|█████████▍| 3963/4227 [00:15<00:01, 257.91it/s]
GT reversal:  94%|█████████▍| 3989/4227 [00:16<00:00, 255.05it/s]
GT reversal:  95%|█████████▍| 4015/4227 [00:16<00:00, 253.94it/s]
GT reversal:  96%|█████████▌| 4042/4227 [00:16<00:00, 256.29it/s]
GT reversal:  96%|█████████▋| 4069/4227 [00:16<00:00, 258.71it/s]
GT reversal:  97%|█████████▋| 4095/4227 [00:16<00:00, 258.92it/s]
GT reversal:  97%|█████████▋| 4121/4227 [00:16<00:00, 257.56it/s]
GT reversal:  98%|█████████▊| 4147/4227 [00:16<00:00, 255.41it/s]
GT reversal:  99%|█████████▊| 4173/4227 [00:16<00:00, 252.77it/s]
GT reversal:  99%|█████████▉| 4199/4227 [00:16<00:00, 253.21it/s]
GT reversal: 100%|█████████▉| 4225/4227 [00:16<00:00, 252.45it/s]
GT reversal: 100%|██████████| 4227/4227 [00:16<00:00, 249.48it/s]

0it [00:00, ?it/s]
160it [00:00, 1492.05it/s]
352it [00:00, 1598.60it/s]
512it [00:00, 1410.11it/s]
672it [00:00, 1305.36it/s]
832it [00:00, 1110.07it/s]
960it [00:00, 1037.27it/s]
1088it [00:00, 1035.67it/s]
1216it [00:01, 988.16it/s] 
1344it [00:01, 947.90it/s]
1472it [00:01, 963.60it/s]
1600it [00:01, 947.86it/s]
1760it [00:01, 1101.15it/s]
1952it [00:01, 1287.93it/s]
2112it [00:01, 1351.70it/s]
2272it [00:01, 1359.85it/s]
2432it [00:02, 1183.96it/s]
2560it [00:02, 1118.04it/s]
2688it [00:02, 1076.37it/s]
2816it [00:02, 1023.06it/s]
2944it [00:02, 992.64it/s] 
3072it [00:02, 981.17it/s]
3200it [00:02, 960.74it/s]
3328it [00:03, 936.22it/s]
3424it [00:03, 932.98it/s]
3520it [00:03, 925.96it/s]
3648it [00:03, 994.04it/s]
3840it [00:03, 1218.71it/s]
4032it [00:03, 1390.63it/s]
4224it [00:03, 1508.72it/s]
4227it [00:03, 1138.30it/s]
