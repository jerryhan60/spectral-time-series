[2025-11-19 12:14:29,957][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:14:29,958][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 270 ground truth sequences
Generating preconditioned model predictions...
Generated 270 forecasts
Creating GT-context-reversed forecasts...
Created 270 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/270 [00:00<?, ?it/s]
Precond model:   0%|          | 1/270 [00:00<01:10,  3.79it/s]
Precond model:  48%|████▊     | 129/270 [00:00<00:00, 303.27it/s]
Precond model: 100%|██████████| 270/270 [00:00<00:00, 449.39it/s]

GT reversal:   0%|          | 0/270 [00:00<?, ?it/s]
GT reversal:   1%|          | 3/270 [00:00<00:12, 21.95it/s]
GT reversal:   2%|▏         | 6/270 [00:00<00:12, 21.85it/s]
GT reversal:   3%|▎         | 9/270 [00:00<00:12, 21.58it/s]
GT reversal:   4%|▍         | 12/270 [00:00<00:12, 21.49it/s]
GT reversal:   6%|▌         | 15/270 [00:00<00:11, 21.42it/s]
GT reversal:   7%|▋         | 18/270 [00:00<00:11, 21.38it/s]
GT reversal:   8%|▊         | 21/270 [00:00<00:11, 21.37it/s]
GT reversal:   9%|▉         | 24/270 [00:01<00:11, 21.34it/s]
GT reversal:  10%|█         | 27/270 [00:01<00:11, 21.33it/s]
GT reversal:  11%|█         | 30/270 [00:01<00:11, 21.30it/s]
GT reversal:  12%|█▏        | 33/270 [00:01<00:11, 21.28it/s]
GT reversal:  13%|█▎        | 36/270 [00:01<00:11, 21.19it/s]
GT reversal:  14%|█▍        | 39/270 [00:01<00:10, 21.25it/s]
GT reversal:  16%|█▌        | 42/270 [00:01<00:10, 21.28it/s]
GT reversal:  17%|█▋        | 45/270 [00:02<00:10, 21.30it/s]
GT reversal:  18%|█▊        | 48/270 [00:02<00:10, 21.31it/s]
GT reversal:  19%|█▉        | 51/270 [00:02<00:10, 21.32it/s]
GT reversal:  20%|██        | 54/270 [00:02<00:10, 21.34it/s]
GT reversal:  21%|██        | 57/270 [00:02<00:09, 21.34it/s]
GT reversal:  22%|██▏       | 60/270 [00:02<00:09, 21.33it/s]
GT reversal:  23%|██▎       | 63/270 [00:02<00:09, 21.33it/s]
GT reversal:  24%|██▍       | 66/270 [00:03<00:09, 21.34it/s]
GT reversal:  26%|██▌       | 69/270 [00:03<00:09, 21.35it/s]
GT reversal:  27%|██▋       | 72/270 [00:03<00:09, 21.36it/s]
GT reversal:  28%|██▊       | 75/270 [00:03<00:09, 21.35it/s]
GT reversal:  29%|██▉       | 78/270 [00:03<00:08, 21.34it/s]
GT reversal:  30%|███       | 81/270 [00:03<00:08, 21.34it/s]
GT reversal:  31%|███       | 84/270 [00:03<00:08, 21.33it/s]
GT reversal:  32%|███▏      | 87/270 [00:04<00:08, 21.32it/s]
GT reversal:  33%|███▎      | 90/270 [00:04<00:08, 21.32it/s]
GT reversal:  34%|███▍      | 93/270 [00:04<00:08, 21.32it/s]
GT reversal:  36%|███▌      | 96/270 [00:04<00:08, 21.33it/s]
GT reversal:  37%|███▋      | 99/270 [00:04<00:08, 21.34it/s]
GT reversal:  38%|███▊      | 102/270 [00:04<00:07, 21.33it/s]
GT reversal:  39%|███▉      | 105/270 [00:04<00:07, 21.34it/s]
GT reversal:  40%|████      | 108/270 [00:05<00:07, 21.24it/s]
GT reversal:  41%|████      | 111/270 [00:05<00:07, 21.26it/s]
GT reversal:  42%|████▏     | 114/270 [00:05<00:07, 21.28it/s]
GT reversal:  43%|████▎     | 117/270 [00:05<00:07, 21.30it/s]
GT reversal:  44%|████▍     | 120/270 [00:05<00:07, 21.32it/s]
GT reversal:  46%|████▌     | 123/270 [00:05<00:06, 21.33it/s]
GT reversal:  47%|████▋     | 126/270 [00:05<00:06, 21.34it/s]
GT reversal:  48%|████▊     | 129/270 [00:06<00:06, 21.31it/s]
GT reversal:  49%|████▉     | 132/270 [00:06<00:06, 21.33it/s]
GT reversal:  50%|█████     | 135/270 [00:06<00:06, 21.34it/s]
GT reversal:  51%|█████     | 138/270 [00:06<00:06, 21.34it/s]
GT reversal:  52%|█████▏    | 141/270 [00:06<00:06, 21.35it/s]
GT reversal:  53%|█████▎    | 144/270 [00:06<00:05, 21.35it/s]
GT reversal:  54%|█████▍    | 147/270 [00:06<00:05, 21.27it/s]
GT reversal:  56%|█████▌    | 150/270 [00:07<00:05, 21.29it/s]
GT reversal:  57%|█████▋    | 153/270 [00:07<00:05, 21.30it/s]
GT reversal:  58%|█████▊    | 156/270 [00:07<00:05, 21.30it/s]
GT reversal:  59%|█████▉    | 159/270 [00:07<00:05, 21.30it/s]
GT reversal:  60%|██████    | 162/270 [00:07<00:05, 21.33it/s]
GT reversal:  61%|██████    | 165/270 [00:07<00:04, 21.36it/s]
GT reversal:  62%|██████▏   | 168/270 [00:07<00:04, 21.38it/s]
GT reversal:  63%|██████▎   | 171/270 [00:08<00:04, 21.40it/s]
GT reversal:  64%|██████▍   | 174/270 [00:08<00:04, 21.41it/s]
GT reversal:  66%|██████▌   | 177/270 [00:08<00:04, 21.42it/s]
GT reversal:  67%|██████▋   | 180/270 [00:08<00:04, 21.42it/s]
GT reversal:  68%|██████▊   | 183/270 [00:08<00:04, 21.28it/s]
GT reversal:  69%|██████▉   | 186/270 [00:08<00:03, 21.32it/s]
GT reversal:  70%|███████   | 189/270 [00:08<00:03, 21.35it/s]
GT reversal:  71%|███████   | 192/270 [00:08<00:03, 21.37it/s]
GT reversal:  72%|███████▏  | 195/270 [00:09<00:03, 21.38it/s]
GT reversal:  73%|███████▎  | 198/270 [00:09<00:03, 21.39it/s]
GT reversal:  74%|███████▍  | 201/270 [00:09<00:03, 21.38it/s]
GT reversal:  76%|███████▌  | 204/270 [00:09<00:03, 21.39it/s]
GT reversal:  77%|███████▋  | 207/270 [00:09<00:02, 21.40it/s]
GT reversal:  78%|███████▊  | 210/270 [00:09<00:02, 21.39it/s]
GT reversal:  79%|███████▉  | 213/270 [00:09<00:02, 21.40it/s]
GT reversal:  80%|████████  | 216/270 [00:10<00:02, 21.40it/s]
GT reversal:  81%|████████  | 219/270 [00:10<00:02, 21.42it/s]
GT reversal:  82%|████████▏ | 222/270 [00:10<00:02, 21.40it/s]
GT reversal:  83%|████████▎ | 225/270 [00:10<00:02, 21.38it/s]
GT reversal:  84%|████████▍ | 228/270 [00:10<00:01, 21.36it/s]
GT reversal:  86%|████████▌ | 231/270 [00:10<00:01, 21.37it/s]
GT reversal:  87%|████████▋ | 234/270 [00:10<00:01, 21.39it/s]
GT reversal:  88%|████████▊ | 237/270 [00:11<00:01, 21.37it/s]
GT reversal:  89%|████████▉ | 240/270 [00:11<00:01, 21.36it/s]
GT reversal:  90%|█████████ | 243/270 [00:11<00:01, 21.38it/s]
GT reversal:  91%|█████████ | 246/270 [00:11<00:01, 21.40it/s]
GT reversal:  92%|█████████▏| 249/270 [00:11<00:00, 21.41it/s]
GT reversal:  93%|█████████▎| 252/270 [00:11<00:00, 21.41it/s]
GT reversal:  94%|█████████▍| 255/270 [00:11<00:00, 21.37it/s]
GT reversal:  96%|█████████▌| 258/270 [00:12<00:00, 21.44it/s]
GT reversal:  97%|█████████▋| 261/270 [00:12<00:00, 21.68it/s]
GT reversal:  98%|█████████▊| 264/270 [00:12<00:00, 21.78it/s]
GT reversal:  99%|█████████▉| 267/270 [00:12<00:00, 21.89it/s]
GT reversal: 100%|██████████| 270/270 [00:12<00:00, 21.95it/s]
GT reversal: 100%|██████████| 270/270 [00:12<00:00, 21.39it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_kdd_cup_2018_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d5_20251117_204835/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=5', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=kdd_cup_2018_with_missing', 'data.prediction_length=168']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
