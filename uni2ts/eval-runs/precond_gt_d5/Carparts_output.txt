[2025-11-19 12:16:04,440][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:16:04,441][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 5

Preconditioning coefficients: [ 0.     -1.25    0.      0.3125  0.    ]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 2674 ground truth sequences
Generating preconditioned model predictions...
Generated 2674 forecasts
Creating GT-context-reversed forecasts...
Created 2674 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/2674 [00:00<?, ?it/s]
Precond model:   0%|          | 1/2674 [00:00<11:22,  3.91it/s]
Precond model:   7%|▋         | 178/2674 [00:00<00:03, 637.29it/s]
Precond model:  13%|█▎        | 353/2674 [00:00<00:02, 956.00it/s]
Precond model:  20%|██        | 545/2674 [00:00<00:01, 1191.54it/s]
Precond model:  28%|██▊       | 737/2674 [00:00<00:01, 1337.07it/s]
Precond model:  35%|███▍      | 929/2674 [00:00<00:01, 1431.08it/s]
Precond model:  42%|████▏     | 1121/2674 [00:00<00:01, 1493.89it/s]
Precond model:  49%|████▉     | 1313/2674 [00:01<00:00, 1536.63it/s]
Precond model:  55%|█████▌    | 1473/2674 [00:01<00:00, 1547.45it/s]
Precond model:  62%|██████▏   | 1665/2674 [00:01<00:00, 1574.54it/s]
Precond model:  69%|██████▉   | 1857/2674 [00:01<00:00, 1591.89it/s]
Precond model:  77%|███████▋  | 2049/2674 [00:01<00:00, 1603.79it/s]
Precond model:  84%|████████▍ | 2241/2674 [00:01<00:00, 1612.41it/s]
Precond model:  91%|█████████ | 2433/2674 [00:01<00:00, 1619.30it/s]
Precond model:  98%|█████████▊| 2625/2674 [00:01<00:00, 1623.58it/s]
Precond model: 100%|██████████| 2674/2674 [00:01<00:00, 1411.47it/s]

GT reversal:   0%|          | 0/2674 [00:00<?, ?it/s]
GT reversal:   1%|          | 32/2674 [00:00<00:08, 312.57it/s]
GT reversal:   2%|▏         | 64/2674 [00:00<00:08, 313.44it/s]
GT reversal:   4%|▎         | 96/2674 [00:00<00:08, 313.43it/s]
GT reversal:   5%|▍         | 128/2674 [00:00<00:08, 313.85it/s]
GT reversal:   6%|▌         | 160/2674 [00:00<00:08, 313.99it/s]
GT reversal:   7%|▋         | 192/2674 [00:00<00:07, 314.23it/s]
GT reversal:   8%|▊         | 224/2674 [00:00<00:07, 314.63it/s]
GT reversal:  10%|▉         | 256/2674 [00:00<00:07, 314.64it/s]
GT reversal:  11%|█         | 288/2674 [00:00<00:07, 312.80it/s]
GT reversal:  12%|█▏        | 320/2674 [00:01<00:07, 313.53it/s]
GT reversal:  13%|█▎        | 352/2674 [00:01<00:07, 313.69it/s]
GT reversal:  14%|█▍        | 384/2674 [00:01<00:07, 313.97it/s]
GT reversal:  16%|█▌        | 416/2674 [00:01<00:07, 313.85it/s]
GT reversal:  17%|█▋        | 448/2674 [00:01<00:07, 314.24it/s]
GT reversal:  18%|█▊        | 480/2674 [00:01<00:06, 314.20it/s]
GT reversal:  19%|█▉        | 512/2674 [00:01<00:06, 314.55it/s]
GT reversal:  20%|██        | 544/2674 [00:01<00:06, 314.13it/s]
GT reversal:  22%|██▏       | 576/2674 [00:01<00:06, 314.28it/s]
GT reversal:  23%|██▎       | 608/2674 [00:01<00:06, 313.98it/s]
GT reversal:  24%|██▍       | 640/2674 [00:02<00:06, 314.12it/s]
GT reversal:  25%|██▌       | 672/2674 [00:02<00:06, 314.20it/s]
GT reversal:  26%|██▋       | 704/2674 [00:02<00:06, 314.45it/s]
GT reversal:  28%|██▊       | 736/2674 [00:02<00:06, 314.37it/s]
GT reversal:  29%|██▊       | 768/2674 [00:02<00:06, 314.53it/s]
GT reversal:  30%|██▉       | 800/2674 [00:02<00:05, 314.42it/s]
GT reversal:  31%|███       | 832/2674 [00:02<00:05, 312.45it/s]
GT reversal:  32%|███▏      | 864/2674 [00:02<00:05, 313.02it/s]
GT reversal:  34%|███▎      | 896/2674 [00:02<00:05, 313.45it/s]
GT reversal:  35%|███▍      | 928/2674 [00:02<00:05, 313.48it/s]
GT reversal:  36%|███▌      | 960/2674 [00:03<00:05, 313.73it/s]
GT reversal:  37%|███▋      | 992/2674 [00:03<00:05, 313.61it/s]
GT reversal:  38%|███▊      | 1024/2674 [00:03<00:05, 313.75it/s]
GT reversal:  39%|███▉      | 1056/2674 [00:03<00:05, 313.60it/s]
GT reversal:  41%|████      | 1088/2674 [00:03<00:05, 313.64it/s]
GT reversal:  42%|████▏     | 1120/2674 [00:03<00:04, 313.45it/s]
GT reversal:  43%|████▎     | 1152/2674 [00:03<00:04, 313.75it/s]
GT reversal:  44%|████▍     | 1184/2674 [00:03<00:04, 313.50it/s]
GT reversal:  45%|████▌     | 1216/2674 [00:03<00:04, 313.54it/s]
GT reversal:  47%|████▋     | 1248/2674 [00:03<00:04, 313.32it/s]
GT reversal:  48%|████▊     | 1280/2674 [00:04<00:04, 313.49it/s]
GT reversal:  49%|████▉     | 1312/2674 [00:04<00:04, 313.19it/s]
GT reversal:  50%|█████     | 1344/2674 [00:04<00:04, 313.48it/s]
GT reversal:  51%|█████▏    | 1376/2674 [00:04<00:04, 313.59it/s]
GT reversal:  53%|█████▎    | 1408/2674 [00:04<00:04, 312.60it/s]
GT reversal:  54%|█████▍    | 1440/2674 [00:04<00:03, 312.71it/s]
GT reversal:  55%|█████▌    | 1472/2674 [00:04<00:03, 313.11it/s]
GT reversal:  56%|█████▌    | 1504/2674 [00:04<00:03, 313.03it/s]
GT reversal:  57%|█████▋    | 1536/2674 [00:04<00:03, 313.44it/s]
GT reversal:  59%|█████▊    | 1568/2674 [00:04<00:03, 312.71it/s]
GT reversal:  60%|█████▉    | 1600/2674 [00:05<00:03, 313.13it/s]
GT reversal:  61%|██████    | 1632/2674 [00:05<00:03, 313.24it/s]
GT reversal:  62%|██████▏   | 1664/2674 [00:05<00:03, 313.35it/s]
GT reversal:  63%|██████▎   | 1696/2674 [00:05<00:03, 312.97it/s]
GT reversal:  65%|██████▍   | 1728/2674 [00:05<00:03, 313.30it/s]
GT reversal:  66%|██████▌   | 1760/2674 [00:05<00:02, 313.19it/s]
GT reversal:  67%|██████▋   | 1792/2674 [00:05<00:02, 313.41it/s]
GT reversal:  68%|██████▊   | 1824/2674 [00:05<00:02, 313.30it/s]
GT reversal:  69%|██████▉   | 1856/2674 [00:05<00:02, 313.47it/s]
GT reversal:  71%|███████   | 1888/2674 [00:06<00:02, 313.33it/s]
GT reversal:  72%|███████▏  | 1920/2674 [00:06<00:02, 313.45it/s]
GT reversal:  73%|███████▎  | 1952/2674 [00:06<00:02, 313.35it/s]
GT reversal:  74%|███████▍  | 1984/2674 [00:06<00:02, 313.51it/s]
GT reversal:  75%|███████▌  | 2016/2674 [00:06<00:02, 313.36it/s]
GT reversal:  77%|███████▋  | 2048/2674 [00:06<00:01, 313.48it/s]
GT reversal:  78%|███████▊  | 2080/2674 [00:06<00:01, 313.35it/s]
GT reversal:  79%|███████▉  | 2112/2674 [00:06<00:01, 313.75it/s]
GT reversal:  80%|████████  | 2144/2674 [00:06<00:01, 313.70it/s]
GT reversal:  81%|████████▏ | 2176/2674 [00:06<00:01, 313.86it/s]
GT reversal:  83%|████████▎ | 2208/2674 [00:07<00:01, 313.71it/s]
GT reversal:  84%|████████▍ | 2240/2674 [00:07<00:01, 313.78it/s]
GT reversal:  85%|████████▍ | 2272/2674 [00:07<00:01, 313.61it/s]
GT reversal:  86%|████████▌ | 2304/2674 [00:07<00:01, 313.65it/s]
GT reversal:  87%|████████▋ | 2336/2674 [00:07<00:01, 313.51it/s]
GT reversal:  89%|████████▊ | 2368/2674 [00:07<00:00, 313.65it/s]
GT reversal:  90%|████████▉ | 2400/2674 [00:07<00:00, 313.40it/s]
GT reversal:  91%|█████████ | 2432/2674 [00:07<00:00, 313.35it/s]
GT reversal:  92%|█████████▏| 2464/2674 [00:07<00:00, 311.37it/s]
GT reversal:  93%|█████████▎| 2496/2674 [00:07<00:00, 311.88it/s]
GT reversal:  95%|█████████▍| 2528/2674 [00:08<00:00, 312.16it/s]
GT reversal:  96%|█████████▌| 2560/2674 [00:08<00:00, 312.56it/s]
GT reversal:  97%|█████████▋| 2592/2674 [00:08<00:00, 312.82it/s]
GT reversal:  98%|█████████▊| 2624/2674 [00:08<00:00, 313.14it/s]
GT reversal:  99%|█████████▉| 2656/2674 [00:08<00:00, 313.01it/s]
GT reversal: 100%|██████████| 2674/2674 [00:08<00:00, 313.48it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_car_parts_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d5_20251117_204835/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=5', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=car_parts_with_missing', 'data.prediction_length=12']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
