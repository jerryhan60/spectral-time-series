================================================================================
Baseline Model Evaluation in Preconditioned Space
================================================================================

Preconditioning Configuration:
  Type: chebyshev
  Degree: 5

Loading test data: m4_hourly
  Prediction length: 48
[2025-11-17 01:56:59,434][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-17 01:56:59,435][datasets][INFO] - JAX version 0.6.1 available.
  Target dim: 1
  Feat dynamic real dim: 0
  Past feat dynamic real dim: 0

Loading baseline model: uni2ts.model.moirai.MoiraiForecast.load_from_checkpoint
  Patch size: 32
  Context length: 1000
  Checkpoint: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/pretrain_run_20251020_205126/checkpoints/last.ckpt

Generating forecasts from baseline model...
Generated 414 forecasts

Applying preconditioning to both predictions and ground truth...
Preconditioned 414 forecasts and ground truth

Computing metrics in preconditioned space...
================================================================================

================================================================================
EVALUATION METRICS (BASELINE IN PRECONDITIONED SPACE)
================================================================================
       MSE[mean]  MAE[0.5]  MAPE[0.5]  sMAPE[0.5]  MASE[0.5]  RMSE[mean]  NRMSE[mean]  ND[0.5]   MSIS  mean_weighted_sum_quantile_loss
None 4893692.918   356.658      0.156       0.120      1.528    2212.169        0.294    0.047 17.075                            0.037
================================================================================

Results saved to: /scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/eval_baseline_in_precond_space/monash_cached/m4_hourly/S/prediction_length=48/eval_baseline_precond_m4_hourly/metrics_baseline_in_precond_space.csv



Preconditioning:   0%|          | 0/414 [00:00<?, ?it/s]
Preconditioning:   0%|          | 2/414 [00:00<00:27, 15.02it/s]
Preconditioning:   1%|          | 4/414 [00:00<00:27, 15.05it/s]
Preconditioning:   1%|▏         | 6/414 [00:00<00:27, 15.06it/s]
Preconditioning:   2%|▏         | 8/414 [00:00<00:26, 15.06it/s]
Preconditioning:   2%|▏         | 10/414 [00:00<00:26, 15.06it/s]
Preconditioning:   3%|▎         | 12/414 [00:00<00:26, 15.05it/s]
Preconditioning:   3%|▎         | 14/414 [00:00<00:26, 15.05it/s]
Preconditioning:   4%|▍         | 16/414 [00:01<00:26, 15.04it/s]
Preconditioning:   4%|▍         | 18/414 [00:01<00:26, 15.04it/s]
Preconditioning:   5%|▍         | 20/414 [00:01<00:27, 14.57it/s]
Preconditioning:   5%|▌         | 22/414 [00:01<00:26, 14.52it/s]
Preconditioning:   6%|▌         | 24/414 [00:01<00:26, 14.46it/s]
Preconditioning:   6%|▋         | 26/414 [00:01<00:26, 14.55it/s]
Preconditioning:   7%|▋         | 28/414 [00:01<00:26, 14.69it/s]
Preconditioning:   7%|▋         | 30/414 [00:02<00:25, 14.79it/s]
Preconditioning:   8%|▊         | 32/414 [00:02<00:25, 14.86it/s]
Preconditioning:   8%|▊         | 34/414 [00:02<00:25, 14.91it/s]
Preconditioning:   9%|▊         | 36/414 [00:02<00:25, 14.95it/s]
Preconditioning:   9%|▉         | 38/414 [00:02<00:25, 14.98it/s]
Preconditioning:  10%|▉         | 40/414 [00:02<00:24, 15.00it/s]
Preconditioning:  10%|█         | 42/414 [00:02<00:24, 15.02it/s]
Preconditioning:  11%|█         | 44/414 [00:02<00:24, 15.02it/s]
Preconditioning:  11%|█         | 46/414 [00:03<00:25, 14.65it/s]
Preconditioning:  12%|█▏        | 48/414 [00:03<00:24, 14.76it/s]
Preconditioning:  12%|█▏        | 50/414 [00:03<00:24, 14.84it/s]
Preconditioning:  13%|█▎        | 52/414 [00:03<00:24, 14.50it/s]
Preconditioning:  13%|█▎        | 54/414 [00:03<00:24, 14.56it/s]
Preconditioning:  14%|█▎        | 56/414 [00:03<00:24, 14.70it/s]
Preconditioning:  14%|█▍        | 58/414 [00:03<00:24, 14.80it/s]
Preconditioning:  14%|█▍        | 60/414 [00:04<00:23, 14.87it/s]
Preconditioning:  15%|█▍        | 62/414 [00:04<00:23, 14.92it/s]
Preconditioning:  15%|█▌        | 64/414 [00:04<00:23, 14.96it/s]
Preconditioning:  16%|█▌        | 66/414 [00:04<00:23, 14.98it/s]
Preconditioning:  16%|█▋        | 68/414 [00:04<00:23, 15.00it/s]
Preconditioning:  17%|█▋        | 70/414 [00:04<00:22, 15.01it/s]
Preconditioning:  17%|█▋        | 72/414 [00:04<00:22, 15.02it/s]
Preconditioning:  18%|█▊        | 74/414 [00:04<00:22, 15.03it/s]
Preconditioning:  18%|█▊        | 76/414 [00:05<00:22, 15.03it/s]
Preconditioning:  19%|█▉        | 78/414 [00:05<00:22, 15.02it/s]
Preconditioning:  19%|█▉        | 80/414 [00:05<00:22, 15.03it/s]
Preconditioning:  20%|█▉        | 82/414 [00:05<00:22, 15.03it/s]
Preconditioning:  20%|██        | 84/414 [00:05<00:21, 15.03it/s]
Preconditioning:  21%|██        | 86/414 [00:05<00:21, 15.03it/s]
Preconditioning:  21%|██▏       | 88/414 [00:05<00:21, 15.02it/s]
Preconditioning:  22%|██▏       | 90/414 [00:06<00:21, 15.02it/s]
Preconditioning:  22%|██▏       | 92/414 [00:06<00:21, 14.99it/s]
Preconditioning:  23%|██▎       | 94/414 [00:06<00:21, 15.01it/s]
Preconditioning:  23%|██▎       | 96/414 [00:06<00:21, 15.01it/s]
Preconditioning:  24%|██▎       | 98/414 [00:06<00:21, 15.01it/s]
Preconditioning:  24%|██▍       | 100/414 [00:06<00:20, 15.03it/s]
Preconditioning:  25%|██▍       | 102/414 [00:06<00:20, 15.02it/s]
Preconditioning:  25%|██▌       | 104/414 [00:06<00:20, 15.03it/s]
Preconditioning:  26%|██▌       | 106/414 [00:07<00:20, 15.04it/s]
Preconditioning:  26%|██▌       | 108/414 [00:07<00:20, 15.05it/s]
Preconditioning:  27%|██▋       | 110/414 [00:07<00:20, 15.03it/s]
Preconditioning:  27%|██▋       | 112/414 [00:07<00:20, 15.03it/s]
Preconditioning:  28%|██▊       | 114/414 [00:07<00:19, 15.03it/s]
Preconditioning:  28%|██▊       | 116/414 [00:07<00:19, 15.04it/s]
Preconditioning:  29%|██▊       | 118/414 [00:07<00:19, 15.04it/s]
Preconditioning:  29%|██▉       | 120/414 [00:08<00:19, 15.03it/s]
Preconditioning:  29%|██▉       | 122/414 [00:08<00:19, 15.02it/s]
Preconditioning:  30%|██▉       | 124/414 [00:08<00:19, 14.60it/s]
Preconditioning:  30%|███       | 126/414 [00:08<00:19, 14.73it/s]
Preconditioning:  31%|███       | 128/414 [00:08<00:19, 14.82it/s]
Preconditioning:  31%|███▏      | 130/414 [00:08<00:19, 14.89it/s]
Preconditioning:  32%|███▏      | 132/414 [00:08<00:18, 14.94it/s]
Preconditioning:  32%|███▏      | 134/414 [00:08<00:18, 14.97it/s]
Preconditioning:  33%|███▎      | 136/414 [00:09<00:18, 15.00it/s]
Preconditioning:  33%|███▎      | 138/414 [00:09<00:18, 15.01it/s]
Preconditioning:  34%|███▍      | 140/414 [00:09<00:18, 15.03it/s]
Preconditioning:  34%|███▍      | 142/414 [00:09<00:18, 15.03it/s]
Preconditioning:  35%|███▍      | 144/414 [00:09<00:17, 15.04it/s]
Preconditioning:  35%|███▌      | 146/414 [00:09<00:17, 15.05it/s]
Preconditioning:  36%|███▌      | 148/414 [00:09<00:17, 15.05it/s]
Preconditioning:  36%|███▌      | 150/414 [00:10<00:18, 14.64it/s]
Preconditioning:  37%|███▋      | 152/414 [00:10<00:17, 14.76it/s]
Preconditioning:  37%|███▋      | 154/414 [00:10<00:17, 14.85it/s]
Preconditioning:  38%|███▊      | 156/414 [00:10<00:17, 14.91it/s]
Preconditioning:  38%|███▊      | 158/414 [00:10<00:17, 14.95it/s]
Preconditioning:  39%|███▊      | 160/414 [00:10<00:16, 14.98it/s]
Preconditioning:  39%|███▉      | 162/414 [00:10<00:16, 15.00it/s]
Preconditioning:  40%|███▉      | 164/414 [00:10<00:16, 15.01it/s]
Preconditioning:  40%|████      | 166/414 [00:11<00:16, 15.02it/s]
Preconditioning:  41%|████      | 168/414 [00:11<00:16, 15.03it/s]
Preconditioning:  41%|████      | 170/414 [00:11<00:17, 14.27it/s]
Preconditioning:  42%|████▏     | 172/414 [00:11<00:18, 13.13it/s]
Preconditioning:  42%|████▏     | 174/414 [00:11<00:19, 12.44it/s]
Preconditioning:  43%|████▎     | 176/414 [00:11<00:19, 12.00it/s]
Preconditioning:  43%|████▎     | 178/414 [00:12<00:20, 11.45it/s]
Preconditioning:  43%|████▎     | 180/414 [00:12<00:20, 11.34it/s]
Preconditioning:  44%|████▍     | 182/414 [00:12<00:20, 11.26it/s]
Preconditioning:  44%|████▍     | 184/414 [00:12<00:20, 10.98it/s]
Preconditioning:  45%|████▍     | 186/414 [00:12<00:20, 11.02it/s]
Preconditioning:  45%|████▌     | 188/414 [00:13<00:20, 11.04it/s]
Preconditioning:  46%|████▌     | 190/414 [00:13<00:20, 11.07it/s]
Preconditioning:  46%|████▋     | 192/414 [00:13<00:20, 11.08it/s]
Preconditioning:  47%|████▋     | 194/414 [00:13<00:19, 11.09it/s]
Preconditioning:  47%|████▋     | 196/414 [00:13<00:19, 11.09it/s]
Preconditioning:  48%|████▊     | 198/414 [00:13<00:19, 11.10it/s]
Preconditioning:  48%|████▊     | 200/414 [00:14<00:19, 11.10it/s]
Preconditioning:  49%|████▉     | 202/414 [00:14<00:19, 10.88it/s]
Preconditioning:  49%|████▉     | 204/414 [00:14<00:19, 10.94it/s]
Preconditioning:  50%|████▉     | 206/414 [00:14<00:18, 10.97it/s]
Preconditioning:  50%|█████     | 208/414 [00:14<00:18, 11.01it/s]
Preconditioning:  51%|█████     | 210/414 [00:15<00:18, 11.04it/s]
Preconditioning:  51%|█████     | 212/414 [00:15<00:18, 11.06it/s]
Preconditioning:  52%|█████▏    | 214/414 [00:15<00:18, 11.07it/s]
Preconditioning:  52%|█████▏    | 216/414 [00:15<00:18, 10.87it/s]
Preconditioning:  53%|█████▎    | 218/414 [00:15<00:18, 10.70it/s]
Preconditioning:  53%|█████▎    | 220/414 [00:15<00:17, 10.82it/s]
Preconditioning:  54%|█████▎    | 222/414 [00:16<00:17, 10.90it/s]
Preconditioning:  54%|█████▍    | 224/414 [00:16<00:17, 10.96it/s]
Preconditioning:  55%|█████▍    | 226/414 [00:16<00:17, 11.00it/s]
Preconditioning:  55%|█████▌    | 228/414 [00:16<00:16, 11.04it/s]
Preconditioning:  56%|█████▌    | 230/414 [00:16<00:16, 11.00it/s]
Preconditioning:  56%|█████▌    | 232/414 [00:17<00:16, 11.03it/s]
Preconditioning:  57%|█████▋    | 234/414 [00:17<00:16, 10.83it/s]
Preconditioning:  57%|█████▋    | 236/414 [00:17<00:16, 10.91it/s]
Preconditioning:  57%|█████▋    | 238/414 [00:17<00:16, 10.97it/s]
Preconditioning:  58%|█████▊    | 240/414 [00:17<00:15, 11.01it/s]
Preconditioning:  58%|█████▊    | 242/414 [00:17<00:15, 11.04it/s]
Preconditioning:  59%|█████▉    | 244/414 [00:18<00:15, 11.06it/s]
Preconditioning:  59%|█████▉    | 246/414 [00:18<00:15, 11.08it/s]
Preconditioning:  60%|█████▉    | 248/414 [00:18<00:14, 11.09it/s]
Preconditioning:  60%|██████    | 250/414 [00:18<00:14, 11.11it/s]
Preconditioning:  61%|██████    | 252/414 [00:18<00:14, 11.12it/s]
Preconditioning:  61%|██████▏   | 254/414 [00:19<00:14, 11.11it/s]
Preconditioning:  62%|██████▏   | 256/414 [00:19<00:14, 11.11it/s]
Preconditioning:  62%|██████▏   | 258/414 [00:19<00:14, 11.11it/s]
Preconditioning:  63%|██████▎   | 260/414 [00:19<00:13, 11.12it/s]
Preconditioning:  63%|██████▎   | 262/414 [00:19<00:13, 11.12it/s]
Preconditioning:  64%|██████▍   | 264/414 [00:19<00:13, 11.13it/s]
Preconditioning:  64%|██████▍   | 266/414 [00:20<00:13, 11.12it/s]
Preconditioning:  65%|██████▍   | 268/414 [00:20<00:13, 11.12it/s]
Preconditioning:  65%|██████▌   | 270/414 [00:20<00:12, 11.13it/s]
Preconditioning:  66%|██████▌   | 272/414 [00:20<00:12, 11.13it/s]
Preconditioning:  66%|██████▌   | 274/414 [00:20<00:12, 11.14it/s]
Preconditioning:  67%|██████▋   | 276/414 [00:21<00:12, 11.14it/s]
Preconditioning:  67%|██████▋   | 278/414 [00:21<00:12, 11.13it/s]
Preconditioning:  68%|██████▊   | 280/414 [00:21<00:12, 11.13it/s]
Preconditioning:  68%|██████▊   | 282/414 [00:21<00:11, 11.13it/s]
Preconditioning:  69%|██████▊   | 284/414 [00:21<00:11, 11.13it/s]
Preconditioning:  69%|██████▉   | 286/414 [00:21<00:11, 11.13it/s]
Preconditioning:  70%|██████▉   | 288/414 [00:22<00:11, 10.89it/s]
Preconditioning:  70%|███████   | 290/414 [00:22<00:11, 10.95it/s]
Preconditioning:  71%|███████   | 292/414 [00:22<00:11, 11.00it/s]
Preconditioning:  71%|███████   | 294/414 [00:22<00:10, 11.04it/s]
Preconditioning:  71%|███████▏  | 296/414 [00:22<00:10, 11.07it/s]
Preconditioning:  72%|███████▏  | 298/414 [00:23<00:10, 11.10it/s]
Preconditioning:  72%|███████▏  | 300/414 [00:23<00:10, 11.11it/s]
Preconditioning:  73%|███████▎  | 302/414 [00:23<00:10, 11.12it/s]
Preconditioning:  73%|███████▎  | 304/414 [00:23<00:09, 11.12it/s]
Preconditioning:  74%|███████▍  | 306/414 [00:23<00:09, 11.13it/s]
Preconditioning:  74%|███████▍  | 308/414 [00:23<00:09, 10.92it/s]
Preconditioning:  75%|███████▍  | 310/414 [00:24<00:09, 10.99it/s]
Preconditioning:  75%|███████▌  | 312/414 [00:24<00:09, 11.03it/s]
Preconditioning:  76%|███████▌  | 314/414 [00:24<00:09, 11.06it/s]
Preconditioning:  76%|███████▋  | 316/414 [00:24<00:08, 11.09it/s]
Preconditioning:  77%|███████▋  | 318/414 [00:24<00:08, 11.10it/s]
Preconditioning:  77%|███████▋  | 320/414 [00:25<00:08, 11.11it/s]
Preconditioning:  78%|███████▊  | 322/414 [00:25<00:08, 10.88it/s]
Preconditioning:  78%|███████▊  | 324/414 [00:25<00:08, 10.96it/s]
Preconditioning:  79%|███████▊  | 326/414 [00:25<00:07, 11.01it/s]
Preconditioning:  79%|███████▉  | 328/414 [00:25<00:07, 11.05it/s]
Preconditioning:  80%|███████▉  | 330/414 [00:25<00:07, 11.07it/s]
Preconditioning:  80%|████████  | 332/414 [00:26<00:07, 11.09it/s]
Preconditioning:  81%|████████  | 334/414 [00:26<00:07, 11.10it/s]
Preconditioning:  81%|████████  | 336/414 [00:26<00:07, 11.12it/s]
Preconditioning:  82%|████████▏ | 338/414 [00:26<00:06, 11.13it/s]
Preconditioning:  82%|████████▏ | 340/414 [00:26<00:06, 10.91it/s]
Preconditioning:  83%|████████▎ | 342/414 [00:27<00:06, 10.98it/s]
Preconditioning:  83%|████████▎ | 344/414 [00:27<00:06, 10.72it/s]
Preconditioning:  84%|████████▎ | 346/414 [00:27<00:06, 10.85it/s]
Preconditioning:  84%|████████▍ | 348/414 [00:27<00:06, 10.94it/s]
Preconditioning:  85%|████████▍ | 350/414 [00:27<00:05, 11.01it/s]
Preconditioning:  85%|████████▌ | 352/414 [00:27<00:05, 11.06it/s]
Preconditioning:  86%|████████▌ | 354/414 [00:28<00:05, 10.95it/s]
Preconditioning:  86%|████████▌ | 356/414 [00:28<00:05, 11.01it/s]
Preconditioning:  86%|████████▋ | 358/414 [00:28<00:05, 11.06it/s]
Preconditioning:  87%|████████▋ | 360/414 [00:28<00:04, 11.09it/s]
Preconditioning:  87%|████████▋ | 362/414 [00:28<00:04, 10.87it/s]
Preconditioning:  88%|████████▊ | 364/414 [00:29<00:04, 10.95it/s]
Preconditioning:  88%|████████▊ | 366/414 [00:29<00:04, 10.78it/s]
Preconditioning:  89%|████████▉ | 368/414 [00:29<00:04, 10.89it/s]
Preconditioning:  89%|████████▉ | 370/414 [00:29<00:04, 10.97it/s]
Preconditioning:  90%|████████▉ | 372/414 [00:29<00:03, 11.03it/s]
Preconditioning:  90%|█████████ | 374/414 [00:29<00:03, 11.06it/s]
Preconditioning:  91%|█████████ | 376/414 [00:30<00:03, 11.09it/s]
Preconditioning:  91%|█████████▏| 378/414 [00:30<00:03, 11.11it/s]
Preconditioning:  92%|█████████▏| 380/414 [00:30<00:03, 11.13it/s]
Preconditioning:  92%|█████████▏| 382/414 [00:30<00:02, 11.15it/s]
Preconditioning:  93%|█████████▎| 384/414 [00:30<00:02, 10.94it/s]
Preconditioning:  93%|█████████▎| 386/414 [00:31<00:02, 11.01it/s]
Preconditioning:  94%|█████████▎| 388/414 [00:31<00:02, 10.94it/s]
Preconditioning:  94%|█████████▍| 390/414 [00:31<00:02, 10.92it/s]
Preconditioning:  95%|█████████▍| 392/414 [00:31<00:02, 11.00it/s]
Preconditioning:  95%|█████████▌| 394/414 [00:31<00:01, 11.05it/s]
Preconditioning:  96%|█████████▌| 396/414 [00:31<00:01, 11.09it/s]
Preconditioning:  96%|█████████▌| 398/414 [00:32<00:01, 11.11it/s]
Preconditioning:  97%|█████████▋| 400/414 [00:32<00:01, 11.14it/s]
Preconditioning:  97%|█████████▋| 402/414 [00:32<00:01, 11.15it/s]
Preconditioning:  98%|█████████▊| 404/414 [00:32<00:00, 11.17it/s]
Preconditioning:  98%|█████████▊| 406/414 [00:32<00:00, 10.93it/s]
Preconditioning:  99%|█████████▊| 408/414 [00:33<00:00, 10.80it/s]
Preconditioning:  99%|█████████▉| 410/414 [00:33<00:00, 10.91it/s]
Preconditioning: 100%|█████████▉| 412/414 [00:33<00:00, 10.99it/s]
Preconditioning: 100%|██████████| 414/414 [00:33<00:00, 11.06it/s]
Preconditioning: 100%|██████████| 414/414 [00:33<00:00, 12.34it/s]

0it [00:00, ?it/s]
160it [00:00, 1586.31it/s]
320it [00:00, 1545.90it/s]
414it [00:00, 1544.61it/s]
