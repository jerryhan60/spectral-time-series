[2025-11-19 12:11:57,565][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:11:57,565][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 270 ground truth sequences
Generating preconditioned model predictions...
Generated 270 forecasts
Creating GT-context-reversed forecasts...
Created 270 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/270 [00:00<?, ?it/s]
Precond model:   0%|          | 1/270 [00:00<01:18,  3.45it/s]
Precond model:  48%|████▊     | 129/270 [00:00<00:00, 288.39it/s]
Precond model: 100%|██████████| 270/270 [00:00<00:00, 430.85it/s]

GT reversal:   0%|          | 0/270 [00:00<?, ?it/s]
GT reversal:   2%|▏         | 6/270 [00:00<00:05, 51.88it/s]
GT reversal:   4%|▍         | 12/270 [00:00<00:05, 51.13it/s]
GT reversal:   7%|▋         | 18/270 [00:00<00:04, 50.93it/s]
GT reversal:   9%|▉         | 24/270 [00:00<00:04, 50.88it/s]
GT reversal:  11%|█         | 30/270 [00:00<00:04, 50.81it/s]
GT reversal:  13%|█▎        | 36/270 [00:00<00:04, 50.78it/s]
GT reversal:  16%|█▌        | 42/270 [00:00<00:04, 50.77it/s]
GT reversal:  18%|█▊        | 48/270 [00:00<00:04, 50.78it/s]
GT reversal:  20%|██        | 54/270 [00:01<00:04, 50.79it/s]
GT reversal:  22%|██▏       | 60/270 [00:01<00:04, 50.80it/s]
GT reversal:  24%|██▍       | 66/270 [00:01<00:04, 49.06it/s]
GT reversal:  27%|██▋       | 72/270 [00:01<00:03, 49.57it/s]
GT reversal:  29%|██▉       | 78/270 [00:01<00:03, 49.94it/s]
GT reversal:  31%|███       | 84/270 [00:01<00:03, 49.84it/s]
GT reversal:  33%|███▎      | 90/270 [00:01<00:03, 50.14it/s]
GT reversal:  36%|███▌      | 96/270 [00:01<00:03, 50.34it/s]
GT reversal:  38%|███▊      | 102/270 [00:02<00:03, 50.49it/s]
GT reversal:  40%|████      | 108/270 [00:02<00:03, 50.61it/s]
GT reversal:  42%|████▏     | 114/270 [00:02<00:03, 50.66it/s]
GT reversal:  44%|████▍     | 120/270 [00:02<00:02, 50.70it/s]
GT reversal:  47%|████▋     | 126/270 [00:02<00:02, 50.72it/s]
GT reversal:  49%|████▉     | 132/270 [00:02<00:02, 50.75it/s]
GT reversal:  51%|█████     | 138/270 [00:02<00:02, 50.76it/s]
GT reversal:  53%|█████▎    | 144/270 [00:02<00:02, 50.74it/s]
GT reversal:  56%|█████▌    | 150/270 [00:02<00:02, 50.78it/s]
GT reversal:  58%|█████▊    | 156/270 [00:03<00:02, 50.77it/s]
GT reversal:  60%|██████    | 162/270 [00:03<00:02, 50.77it/s]
GT reversal:  62%|██████▏   | 168/270 [00:03<00:02, 50.75it/s]
GT reversal:  64%|██████▍   | 174/270 [00:03<00:01, 50.78it/s]
GT reversal:  67%|██████▋   | 180/270 [00:03<00:01, 50.75it/s]
GT reversal:  69%|██████▉   | 186/270 [00:03<00:01, 50.75it/s]
GT reversal:  71%|███████   | 192/270 [00:03<00:01, 50.73it/s]
GT reversal:  73%|███████▎  | 198/270 [00:03<00:01, 50.74it/s]
GT reversal:  76%|███████▌  | 204/270 [00:04<00:01, 50.76it/s]
GT reversal:  78%|███████▊  | 210/270 [00:04<00:01, 50.75it/s]
GT reversal:  80%|████████  | 216/270 [00:04<00:01, 50.74it/s]
GT reversal:  82%|████████▏ | 222/270 [00:04<00:00, 50.76it/s]
GT reversal:  84%|████████▍ | 228/270 [00:04<00:00, 50.74it/s]
GT reversal:  87%|████████▋ | 234/270 [00:04<00:00, 50.74it/s]
GT reversal:  89%|████████▉ | 240/270 [00:04<00:00, 50.72it/s]
GT reversal:  91%|█████████ | 246/270 [00:04<00:00, 49.19it/s]
GT reversal:  93%|█████████▎| 252/270 [00:04<00:00, 49.66it/s]
GT reversal:  95%|█████████▌| 257/270 [00:05<00:00, 49.57it/s]
GT reversal:  97%|█████████▋| 263/270 [00:05<00:00, 50.22it/s]
GT reversal: 100%|█████████▉| 269/270 [00:05<00:00, 50.63it/s]
GT reversal: 100%|██████████| 270/270 [00:05<00:00, 50.53it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_kdd_cup_2018_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d2_20251117_203920/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=2', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=kdd_cup_2018_with_missing', 'data.prediction_length=168']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
