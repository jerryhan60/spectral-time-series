[2025-11-19 12:13:03,059][datasets][INFO] - PyTorch version 2.4.1 available.
[2025-11-19 12:13:03,060][datasets][INFO] - JAX version 0.6.1 available.
Ground Truth Context Evaluation Configuration:
  Precond model: uni2ts.model.moirai.forecast_precond.create_precond_forecast_from_checkpoint
  Preconditioning type: chebyshev
  Preconditioning degree: 2

Preconditioning coefficients: [ 0.  -0.5]

Loading preconditioned model...
Extracting ground truth (input + label) from test data...
Extracted 2674 ground truth sequences
Generating preconditioned model predictions...
Generated 2674 forecasts
Creating GT-context-reversed forecasts...
Created 2674 GT-context-reversed forecasts
Computing metrics...


Precond model:   0%|          | 0/2674 [00:00<?, ?it/s]
Precond model:   0%|          | 1/2674 [00:00<11:40,  3.81it/s]
Precond model:   7%|▋         | 177/2674 [00:00<00:04, 623.28it/s]
Precond model:  13%|█▎        | 353/2674 [00:00<00:02, 947.00it/s]
Precond model:  20%|██        | 545/2674 [00:00<00:01, 1184.11it/s]
Precond model:  28%|██▊       | 737/2674 [00:00<00:01, 1323.89it/s]
Precond model:  34%|███▎      | 897/2674 [00:00<00:01, 1384.07it/s]
Precond model:  40%|███▉      | 1057/2674 [00:00<00:01, 1422.12it/s]
Precond model:  47%|████▋     | 1249/2674 [00:01<00:00, 1483.42it/s]
Precond model:  53%|█████▎    | 1409/2674 [00:01<00:00, 1512.57it/s]
Precond model:  60%|█████▉    | 1601/2674 [00:01<00:00, 1545.83it/s]
Precond model:  67%|██████▋   | 1793/2674 [00:01<00:00, 1572.03it/s]
Precond model:  74%|███████▍  | 1985/2674 [00:01<00:00, 1589.98it/s]
Precond model:  81%|████████▏ | 2177/2674 [00:01<00:00, 1602.47it/s]
Precond model:  89%|████████▊ | 2369/2674 [00:01<00:00, 1611.02it/s]
Precond model:  96%|█████████▌| 2561/2674 [00:01<00:00, 1617.68it/s]
Precond model: 100%|██████████| 2674/2674 [00:01<00:00, 1392.56it/s]

GT reversal:   0%|          | 0/2674 [00:00<?, ?it/s]
GT reversal:   3%|▎         | 71/2674 [00:00<00:03, 701.24it/s]
GT reversal:   5%|▌         | 142/2674 [00:00<00:03, 702.82it/s]
GT reversal:   8%|▊         | 213/2674 [00:00<00:03, 668.23it/s]
GT reversal:  11%|█         | 284/2674 [00:00<00:03, 680.51it/s]
GT reversal:  13%|█▎        | 353/2674 [00:00<00:03, 664.69it/s]
GT reversal:  16%|█▌        | 424/2674 [00:00<00:03, 679.42it/s]
GT reversal:  19%|█▊        | 495/2674 [00:00<00:03, 688.25it/s]
GT reversal:  21%|██        | 566/2674 [00:00<00:03, 694.85it/s]
GT reversal:  24%|██▍       | 636/2674 [00:00<00:02, 693.83it/s]
GT reversal:  26%|██▋       | 707/2674 [00:01<00:02, 697.92it/s]
GT reversal:  29%|██▉       | 778/2674 [00:01<00:02, 700.22it/s]
GT reversal:  32%|███▏      | 849/2674 [00:01<00:02, 702.38it/s]
GT reversal:  34%|███▍      | 920/2674 [00:01<00:02, 704.00it/s]
GT reversal:  37%|███▋      | 991/2674 [00:01<00:02, 703.69it/s]
GT reversal:  40%|███▉      | 1062/2674 [00:01<00:02, 705.13it/s]
GT reversal:  42%|████▏     | 1133/2674 [00:01<00:02, 706.46it/s]
GT reversal:  45%|████▌     | 1204/2674 [00:01<00:02, 706.77it/s]
GT reversal:  48%|████▊     | 1275/2674 [00:01<00:02, 682.37it/s]
GT reversal:  50%|█████     | 1346/2674 [00:01<00:01, 688.63it/s]
GT reversal:  53%|█████▎    | 1416/2674 [00:02<00:01, 668.06it/s]
GT reversal:  56%|█████▌    | 1487/2674 [00:02<00:01, 679.82it/s]
GT reversal:  58%|█████▊    | 1558/2674 [00:02<00:01, 686.88it/s]
GT reversal:  61%|██████    | 1629/2674 [00:02<00:01, 692.48it/s]
GT reversal:  64%|██████▎   | 1700/2674 [00:02<00:01, 696.98it/s]
GT reversal:  66%|██████▋   | 1772/2674 [00:02<00:01, 700.89it/s]
GT reversal:  69%|██████▉   | 1843/2674 [00:02<00:01, 703.40it/s]
GT reversal:  72%|███████▏  | 1914/2674 [00:02<00:01, 699.52it/s]
GT reversal:  74%|███████▍  | 1985/2674 [00:02<00:00, 702.02it/s]
GT reversal:  77%|███████▋  | 2056/2674 [00:02<00:00, 703.66it/s]
GT reversal:  80%|███████▉  | 2127/2674 [00:03<00:00, 704.85it/s]
GT reversal:  82%|████████▏ | 2198/2674 [00:03<00:00, 706.03it/s]
GT reversal:  85%|████████▍ | 2269/2674 [00:03<00:00, 706.75it/s]
GT reversal:  88%|████████▊ | 2340/2674 [00:03<00:00, 706.28it/s]
GT reversal:  90%|█████████ | 2411/2674 [00:03<00:00, 681.91it/s]
GT reversal:  93%|█████████▎| 2482/2674 [00:03<00:00, 690.06it/s]
GT reversal:  95%|█████████▌| 2553/2674 [00:03<00:00, 695.20it/s]
GT reversal:  98%|█████████▊| 2624/2674 [00:03<00:00, 698.96it/s]
GT reversal: 100%|██████████| 2674/2674 [00:03<00:00, 692.76it/s]

0it [00:00, ?it/s]Error executing job with overrides: ['run_name=eval_precond_gt_last_car_parts_with_missing', 'model.checkpoint_path=/scratch/gpfs/EHAZAN/jh1161/uni2ts/outputs/pretrain/moirai_small/lotsa_v1_unweighted/precond_chebyshev_d2_20251117_203920/checkpoints/last.ckpt', 'model.patch_size=32', 'model.context_length=1000', 'model.precondition_type=chebyshev', 'model.precondition_degree=2', 'batch_size=32', 'data=monash_cached', 'data.dataset_name=car_parts_with_missing', 'data.prediction_length=12']
Traceback (most recent call last):
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 375, in main
    res = evaluate_gt_context_model(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/cli/eval_precond_gt.py", line 314, in evaluate_gt_context_model
    res = evaluate_forecasts(
          ^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 201, in evaluate_forecasts
    metrics_values = evaluate_forecasts_raw(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 161, in evaluate_forecasts_raw
    evaluator.update(data_batch)
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/metrics.py", line 101, in update
    self.aggregate.step(self.stat(data))
                        ^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 44, in squared_error
    return np.square(error(data, forecast_type))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/venv/lib/python3.12/site-packages/gluonts/ev/stats.py", line 32, in error
    return data["label"] - data[forecast_type]
                           ~~~~^^^^^^^^^^^^^^^
  File "/usr/licensed/anaconda3/2024.6/lib/python3.12/collections/__init__.py", line 1012, in __getitem__
    return mapping[key]             # can't use 'key in mapping' with defaultdict
           ~~~~~~~^^^^^
  File "/scratch/gpfs/EHAZAN/jh1161/uni2ts/src/uni2ts/eval_util/evaluation.py", line 50, in __getitem__
    raise ValueError("Forecast contains NaN values")
ValueError: Forecast contains NaN values

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

0it [00:00, ?it/s]
